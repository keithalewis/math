<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Keith A. Lewis" />
  <meta name="dcterms.date" content="2024-02-06" />
  <title>Efficient Portfolios</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <link rel="stylesheet" href="math.css" />
  <script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
   var mathElements = document.getElementsByClassName("math");
   for (var i = 0; i < mathElements.length; i++) {
    var texText = mathElements[i].firstChild;
    if (mathElements[i].tagName == "SPAN") {
     katex.render(texText.data, mathElements[i], {
      displayMode: mathElements[i].classList.contains('display'),
      throwOnError: false,
      fleqn: true
     });
  }}});
  </script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">Efficient Portfolios</h1>
<p class="author">Keith A. Lewis</p>
<p class="date">February 6, 2024</p>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#one-period-model">One-Period Model</a></li>
<li><a href="#efficient-portfolio">Efficient Portfolio</a></li>
<li><a href="#appendix">Appendix</a>
<ul>
<li><a href="#fréchet-derivative">Fréchet derivative</a></li>
<li><a href="#lagrange-multiplier">Lagrange Multiplier</a></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul>
</nav>
<p>Given two random realized returns on an investment, which is to be preferred? This is a fundamental problem in finance that has no definitive solution except in the case one investment always returns more than the other, in which case arbitrage exists. In 1952 Markowitz<span class="citation" data-cites="Mar1952">[@Mar1952]</span> and Roy<span class="citation" data-cites="Roy1952">[@Roy1952]</span> introduced the following criterion for risk vs. return in portfolio selection: if two portfolios have the same expected realized return then prefer the one with smaller variance. An <em>efficient portfolio</em> has the least variance among all portfolios having the same expected realized return. This was developed into the Capital Asset Pricing Model by Treynor<span class="citation" data-cites="Tre1961">[@Tre1961]</span>, Sharp<span class="citation" data-cites="Sha1964">[@Sha1964]</span>, Lintner<span class="citation" data-cites="Lin1965">[@Lin1965]</span>, and many others.</p>
<p>In the one-period model every efficient portfolio belongs to a one or two-dimensional subspace and is uniquely determined given its expected realized return. In the one-dimensional case every portfolio has the same expected realized return. We show that if <span class="math inline">R</span> is the (random) realized return of any efficient portfolio and <span class="math inline">R_0</span> and <span class="math inline">R_1</span> are the (random) realized returns of any two linearly independent efficient portfolios then <span class="math display">
    R - R_0 = \beta(R_1 - R_0).
</span> It follows that <span class="math inline">\beta = \operatorname{Cov}(R - R_0, R_1 - R_0)/\operatorname{Var}(R_1 - R_0)</span>. This generalizes the classical Capital Asset Pricing Model formula for the expected realized return of efficient portfolios. Taking expected values of both sides when <span class="math inline">\operatorname{Var}(R_0) = 0</span> and <span class="math inline">R_1</span> is the “market” portfolio gives the classic CAPM formula <span class="math display">
    E[R] - R_0 = \beta(E[R_1] - R_0)
</span> where <span class="math inline">\beta = \operatorname{Cov}(R, R_1)/\operatorname{Var}(R_1)</span>.</p>
<p>This short note points out the CAPM formula holds as equality of realized returns as random variables, not just their expectations. It follows directly from writing down a mathematical model for one period investments. Prior work does not explicitly specify a sample space and probability measure, the first step in any model involving probability since Kolomogorov legitimized probability as a branch of measure theory <span class="citation" data-cites="Kol1956">[@Kol1956]</span>.</p>
<!--
## Background

After the US stock market crash of 1929 the government passed the 1933
Glass-Steagall Act prohibited banks from participating in the stock
market and insurance industry. In 1934 the Securities
and Exchange Commission was established to protect retail investors from market
manipulation by large banks.

In the same year, Benjamin Graham and David Todd, professors at Columbia Business
School at the time, published _Security Analysis_. Their premise was
to value a business based on their current balance sheet and expected future cash flows.

Markowitz was the Marcel Duchamp of portfolio management.  Instead of due
diligence on individual companies he showed how portfolio managers could
use the collective wisdom of publicly available market prices. Market
data and compute power was limited at the time so returns and covariances were based
on daily data.
-->
<section id="one-period-model" class="level2">
<h2>One-Period Model</h2>
<p>Let <span class="math inline">I</span> be the set of <em>market instruments</em> and <span class="math inline">\Omega</span> be the set of possible market outcomes over the period. The <em>one-period model</em> specifies the initial instrument prices <span class="math inline">x\in\mathbf{R}^I</span> and the final instrument prices <span class="math inline">X\colon\Omega\to\mathbf{R}^I</span> depending on the outcome <span class="math inline">\omega\in\Omega</span> that occurs.</p>
<p>The one period model also specifies a probability measure on the space of outcomes. Addressing this fundamental and important problem is outside the scope of this short note.</p>
<!-- in the modern world -->
<p>A <em>portfolio</em> <span class="math inline">\xi\in\mathbf{R}^I</span> is the number of shares initially purchased in each instrument. It costs <span class="math inline">{\xi^* x = \sum_{i\in I} \xi_i x_i}</span> to acquire the portfolio at the beginning of the period and returns <span class="math inline">{\xi^* X(\omega) = \sum_{i\in I} \xi_i X_i(\omega)}</span> when liquidated at the end of the period if <span class="math inline">\omega\in\Omega</span> occurs. The <em>realized return</em> of <span class="math inline">\xi</span> is <span class="math inline">{R_\xi = \xi^* X/\xi^* x}</span> when <span class="math inline">\xi^* x \not= 0</span>.</p>
<!--
_Arbitrage_ exists if there is a portfolio $\xi\in\RR^I$ with $\xi^* x <
0$ and $\xi^* X(\omega) \ge0$, $\omega\in\Omega$.  The cost of acquiring
the portfolio is negative so you make money up front.  The liquidation
value at the end of the period is non-negative no matter what happens so you never lose
money. Note this definition of arbitrage does not involve a probability measure.
The _Fundamental Theorem of Asset Pricing_ for the one-period model
states there is no arbitrage if and only if there exists a positive
finitely additive measure $D$ on $\Omega$ with $x = \int_\Omega X\,dD$. See the
[Appendix](fundamental-theorem-of-asset-pricing) for an elementary proof.
-->
</section>
<section id="efficient-portfolio" class="level2">
<h2>Efficient Portfolio</h2>
<p>A portfolio is <em>efficient</em> if its variance is less than or equal to the variance of any portfolio having the same expected realized return.</p>
<p>Note <span class="math inline">R_\xi = R_{t\xi}</span> for any non-zero <span class="math inline">t\in\mathbf{R}</span> so there is no loss in assuming <span class="math inline">\xi^* x = 1</span>. In this case <span class="math inline">R_\xi = \xi^* X</span> is the realized return of the portfolio. If <span class="math inline">\xi^* x = 1</span> then <span class="math inline">\operatorname{Var}(R_\xi) = \xi^*V\xi</span> where <span class="math inline">V = E[X X^*] - E[X] E[X]^*</span>. <!--
$$
\begin{aligned}
\Var(R_\xi) &= \Cov(R_\xi, R_\xi) \\
    &= \Cov(\xi^*X, \xi^*X) \\
    &= E[\xi^*X \xi^*X] - E[\xi^*X] E[\xi^*X] \\
    &= E[\xi^*X X^*\xi] - E[\xi^*X] E[X^*\xi] \\
    &= \xi^*E[X X^*]\xi - \xi^*E[X] E[X^*]\xi \\
    &= \xi^*(E[X X^*]\xi] - E[X] E[X^*])\xi \\
    &= \xi^*V\xi \\
\end{aligned}
$$
--></p>
<p>For a given expected realized return <span class="math inline">r\in\mathbf{R}</span> we use Lagrange multipliers and minimize <span class="math display">
    \frac{1}{2}\xi^* V\xi - \lambda(\xi^* x - 1) - \mu(\xi^* E[X] - r)
</span> over <span class="math inline">\xi\in\mathbf{R}^I</span>, <span class="math inline">\lambda\in\mathbf{R}</span>, and <span class="math inline">\mu\in\mathbf{R}</span>.</p>
<p>The <a href="#appendix">Appendix</a> shows the first order condition on <span class="math inline">\xi</span> is <span class="math display">
    0 = V\xi - \lambda x - \mu E[X].
</span></p>
<p>If <span class="math inline">V\zeta = 0</span> for some <span class="math inline">\zeta\in\mathbf{R}^I</span> then <span class="math inline">\zeta</span> is a zero coupon bond and <span class="math inline">x = E[X]D</span> where <span class="math inline">D = -\mu/\lambda</span>. In this case every portfolio <span class="math inline">\xi\in\mathbf{R}^I</span> has the same expected realized return <span class="math inline">{E[R_\xi] = E[\xi^*X/\xi^*x] = 1/D}</span> and <span class="math inline">\zeta</span> is clearly optimal.</p>
<p>We assume <span class="math inline">V\xi = 0</span> implies <span class="math inline">\xi = 0</span> so <span class="math inline">V</span> has a left inverse <span class="math inline">V^\dashv</span> hence <span class="math display">
    \xi =  \lambda V^{\dashv}x + \mu V^{\dashv} E[X].
</span></p>
<p>This shows efficient portfolios are in the span of <span class="math inline">V^{\dashv}x</span> and <span class="math inline">V^{\dashv} E[X]</span>. As Black<span class="citation" data-cites="Bla1972">[@Bla1972]</span> showed, there is no need to assume a zero coupon bond is available.</p>
<p>If <span class="math inline">\xi_0</span> and <span class="math inline">\xi_1</span> are any two independent efficient portfolios then <span class="math inline">{\xi = \beta_0\xi_0 + \beta_1\xi_1}</span> for some scalars <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1</span>. Assuming, as we may, that <span class="math inline">\xi_j^* x = 1</span> for <span class="math inline">j = 0,1</span> then <span class="math inline">{\xi^* x = \beta_0 + \beta_1}</span> and <span class="math inline">{\xi^* X = \beta_0 R_{\xi_0} + \beta_1 R_{\xi_1}}</span> so <span class="math inline">{R_\xi = (\beta_0 R_{\xi_0} + \beta_1 R_{\xi_1})/(\beta_0 + \beta_1)}</span>. This shows <span class="math display">
    R_\xi - R_{\xi_0} = \beta(R_{\xi_1} - R_{\xi_0})
</span> as functions on <span class="math inline">\Omega</span>, where <span class="math inline">\beta = \beta_1/(\beta_0 + \beta_1)</span>. Taking the covariance with <span class="math inline">{R_{\xi_1} - R_{\xi_0}}</span> on both sides gives <span class="math display">
    \beta = \operatorname{Cov}(R_\xi - R_{\xi_0}, R_{\xi_1} - R_{\xi_0})/\operatorname{Var}(R_{\xi_1} - R_{\xi_0}).
</span></p>
<p>The <a href="#appendix">Appendix</a> shows <span class="math inline">\lambda = (C - r B)/D</span>, <span class="math inline">\mu = (-B + r A)/D</span>, where <span class="math inline">{A = x^* V^{\dashv}x}</span>, <span class="math inline">{B = x^* V^{\dashv}E[X] = E[X^*]V^{\dashv}x}</span>, <span class="math inline">{C = E[X^*]V^{\dashv}E[X]}</span>, and <span class="math inline">{D = AC - B^2}</span>. Note that <span class="math inline">A</span>, <span class="math inline">B</span>, <span class="math inline">C</span>, and <span class="math inline">D</span> depend only on <span class="math inline">x</span>, <span class="math inline">E[X]</span>, and <span class="math inline">E[XX^*]</span>.</p>
<p>Classical literature makes the implicit assumption <span class="math inline">\Omega = \mathbf{R}^I</span>, so any instrument can go to any price, and that returns are jointly normal to reduce the problem of finding a probability measure to estimating the mean <span class="math inline">E[X]</span> and the covariance <span class="math inline">E[XX^*] - E[X] E[X^*]</span>. This may explain why prior authors overlooked our elementary but stronger result.</p>
</section>
<section id="appendix" class="level2">
<h2>Appendix</h2>
<p>We use the notation <span class="math inline">\xi^*</span> for what is usually denoted by the transpose <span class="math inline">\xi^T</span>. It is simpler and more illuminating to work with abstract vector spaces and linear operators between them than with <span class="math inline">\mathbf{R}^n</span> and matrices. Matrix multiplication is just composition linear operators.</p>
<p>Recall <span class="math inline">\mathbf{R}^I = \{x\colon I\to\mathbf{R}\}</span> is the vector space of all functions from the set <span class="math inline">I</span> to <span class="math inline">\mathbf{R}</span> with scalar multiplication and vector addition defined pointwise: <span class="math inline">{(ax)(i) = ax(i)}</span> and <span class="math inline">{(x + y)(i) = x(i) + y(i)}</span> for <span class="math inline">a\in\mathbf{R}</span>, <span class="math inline">{x,y\in\mathbf{R}^I}</span>, and <span class="math inline">i\in I</span>.</p>
<p>For <span class="math inline">\xi\in\mathbf{R}^I</span> define <span class="math inline">\xi^*\in(\mathbf{R}^I)^*</span> by <span class="math inline">\xi(x) = \xi^*x = \sum_{i\in I} \xi_i x_i</span> if <span class="math inline">I</span> is finite. Note <span class="math inline">\xi^*x = x^*\xi</span> and this identifies <span class="math inline">(\mathbf{R}^I)^*</span> with <span class="math inline">\mathbf{R}^I</span>. The Euclidean norm on <span class="math inline">\mathbf{R}^I</span> is <span class="math inline">\|x\| = \sqrt{x^*x}</span>.</p>
<p>Let <span class="math inline">\mathcal{B}(V,W)</span> be the set of bounded linear operators from a vector space <span class="math inline">V</span> to a vector space <span class="math inline">W</span>. A linear operator <span class="math inline">T\colon V\to W</span> is bounded if there exists <span class="math inline">C\in\mathbf{R}</span> with <span class="math inline">\|Tv\| \le C\|v\|</span> for all <span class="math inline">v\in V</span>. The least such constant is the <em>norm</em> of <span class="math inline">T</span>. Note <span class="math inline">\mathcal{B}(V,W)</span> is also a normed vector space with scalar multiplication and addition defined pointwise.</p>
<p>Define the <em>dual</em> of a vector space <span class="math inline">V</span> to be all <em>bounded linear functionals</em> from <span class="math inline">V</span> to <span class="math inline">\mathbf{R}</span>: <span class="math inline">V^* = \mathcal{B}(V,\mathbf{R})</span>. If <span class="math inline">T\in\mathcal{L}(V,W)</span> define the <em>adjoint</em> <span class="math inline">T^*\in\mathcal{B}(W^*,V^*)</span> by <span class="math inline">T^*w^*\in V^*</span> where <span class="math inline">T^*w^*(v) = w^*(Tv)</span>, <span class="math inline">w^*\in W^*</span>, <span class="math inline">v\in V</span>.</p>
<!--
If $V = \RR^I$ and $W = \RR^J$ where $I$ and $J$
are finite, then given a basis $(e_i)$ of $V$ and a basis $(f_j)$ of $W$
we can define a matrix $[t_{ij}]$ for any linear operator $T\colon V\to W$
by $Te_i = \sum_j t_{ij} f_j$. 
-->
<section id="fréchet-derivative" class="level3">
<h3>Fréchet derivative</h3>
<p>If <span class="math inline">F\colon V\to W</span> is a function between normed vector spaces its Fréchet derivative <span class="math inline">{DF\colon V\to \mathcal{B}(V,W)}</span> is defined by <span class="math display">
    F(\xi + h) = F(\xi) + DF(\xi)h + o(\|h\|).
</span> If the Fréchet derivative exists at <span class="math inline">\xi</span> then <span class="math inline">F</span> can be approximated by a linear operator near <span class="math inline">\xi</span>.</p>
<p>Given <span class="math inline">x\in\mathbf{R}^I</span> define <span class="math inline">F\colon\mathbf{R}^I\to\mathbf{R}</span> by <span class="math inline">F(\xi) = \xi^*x</span>. We have <span class="math inline">{F(\xi + h) = \xi^*x + h^*x + 0}</span> so <span class="math inline">DF(\xi) = x^*</span> since <span class="math inline">h^*x = x^*h</span>.</p>
<p>Given <span class="math inline">T\colon\mathbf{R}^I\to\mathbf{R}^I</span> define <span class="math inline">F\colon\mathbf{R}^I\to\mathbf{R}</span> by <span class="math inline">F(\xi) = \xi^*T\xi</span>. We have <span class="math display">
\begin{aligned}
    F(\xi + h) &amp;= (\xi + h)^*T(\xi + h) \\
        &amp;= \xi^*T\xi + \xi^*Th + h^*T\xi + h^*h \\
        &amp;= \xi^*T\xi + \xi^*Th + \xi^*T^*h + o(\|h\|). \\
\end{aligned}
</span> This shows <span class="math inline">DF(\xi) = \xi^*(T + T^*)</span>.</p>
</section>
<section id="lagrange-multiplier" class="level3">
<h3>Lagrange Multiplier</h3>
<p>To find the minimum value of <span class="math inline">\operatorname{Var}(R_\xi)</span> given <span class="math inline">E[R_\xi] = r</span> we use Lagrange multipliers and solve <span class="math display">
        \min \frac{1}{2}\xi^* V\xi - \lambda(\xi^* x - 1) - \mu(\xi^* E[X] - r)
</span> for <span class="math inline">\xi</span>, <span class="math inline">\lambda</span>, and <span class="math inline">\mu</span>. If <span class="math inline">{\xi^* \xi = 1}</span> then <span class="math inline">{R_\xi = \xi^* E[X]}</span> and <span class="math inline">{\operatorname{Var}(R_\xi) = \xi^* V\xi}</span> where <span class="math inline">{V = E[XX^*] - E[X]E[X^*]}</span>.</p>
<p>The first order conditions for an extremum are <span class="math display">
\begin{aligned}
        0 &amp;= \xi^*V - \lambda x^* - \mu E[X]^* \\
        0 &amp;= \xi^* x - 1 \\
        0 &amp;= \xi^* E[X] - r \\
\end{aligned}
</span> Assuming <span class="math inline">V</span> is left invertible <span class="math inline">\xi = V^{\dashv}(\lambda x + \mu E[X])</span>. Note every extremum lies in the (at most) two dimensional subspace spanned by <span class="math inline">V^{\dashv}x</span> and <span class="math inline">V^{\dashv}E[X]</span>.</p>
<p>The constraints <span class="math inline">1 = x^*\xi</span> and <span class="math inline">r = E[X^*]\xi</span> can be written <span class="math display">
\begin{bmatrix}
1 \\
r \\
\end{bmatrix}
=
\begin{bmatrix}
\lambda x^*V^{\dashv}x + \mu x^*V^{\dashv}E[X] \\
\lambda E[X^*]V^{\dashv}x + \mu E[X^*]V^{\dashv}E[X] \\
\end{bmatrix}
= \begin{bmatrix}
A &amp; B \\
B &amp; C\\
\end{bmatrix}
\begin{bmatrix}
\lambda \\
\mu
\end{bmatrix}
</span> with <span class="math inline">A = x^* V^{\dashv}x</span>, <span class="math inline">B = x^* V^{\dashv}E[X] = E[X^*]V^{\dashv}x</span>, and <span class="math inline">C = E[X^*] V^{\dashv}E[X]</span>. Inverting gives <span class="math display">
\begin{bmatrix} \lambda \\ \mu \end{bmatrix}
= \frac{1}{D}
\begin{bmatrix}
C &amp; -B \\
-B &amp; A\\
\end{bmatrix}
\begin{bmatrix}
1 \\
r
\end{bmatrix}
=
\begin{bmatrix}
(C - r B)/D \\
(-B + r A)/D\\
\end{bmatrix}
</span> where <span class="math inline">D = AC - B^2</span>. The solution is <span class="math inline">\lambda = (C - r B)/D</span>, <span class="math inline">\mu = (-B + r A)/D</span>, and <span class="math display">
    \xi = \frac{C - r B}{D} V^{\dashv}x + \frac{-B + r A}{D} V^{\dashv}E[X].
</span></p>
<p>A straightforward calculation shows the variance is <span class="math display">
\operatorname{Var}(R_\xi) = \xi^* V\xi = (C - 2Br + Ar^2)/D.
</span></p>
</section>
</section>
<section id="references" class="level2">
<h2>References</h2>
<!--

### Fundamental Theorem of Asset Pricing

It may be the case $V^{\dashv}x$ and $V^{\dashv}E[X]$ are dependent.
In this case $x = E[X]D$ for some $D\in\RR$. This
ensures the model is _arbitrage free_.

Arbitrage exists in the one-period model if
there is a $\xi\in\RR^I$ with $\xi^* x < 0$ and $\xi^* X(\omega)\ge0$
for $\omega\in\Omega$: you make money putting on the position
and never lose money unwinding it.

The one-period Fundamental Theorem of Asset Pricing states there is no model
arbitrage if and only if there exists a positive measure $D$ on
$\Omega$ with $x = \int_\Omega X(\omega)\,dD(\omega)$.  We assume $X$
is bounded, as it is in the real world, and $D$ is
finitely additive.

If $x = \sum_j X(\omega_j) d_j$ where $\omega_j\in\Omega$ and $d_j\ge0$ then
$$
    \xi*x = \sum_j \xi^*X(\omega_j) d_j \ge0
$$
if $\xi^*X\ge0$ on $\Omega$.

If $x$ belongs to the smallest closed cone containing the range of $X$ then
$x = \int_\Omega X dD$ for some positive finitely-additive measure $D$ on $\Omega$.
If we define $P = D/D(\Omega)$ then $P$ is a positive measure with mass 1.


If such a measure exists and $\xi^* X\ge0$ then
$\xi^* x = \int_\Omega \xi^* X\,dD \ge0$ so arbitrage
cannot occur. The other direction is less trivial.

__Lemma.__ _If $x\in\RR^n$ and $C$ is a closed cone in
$\RR^n$ with $x\not\in C$ then there exists $\xi\in\RR^n$
with $\xi^* x < 0$ and $\xi^* y \ge0$ for $y\in C$._

Recall that a _cone_ is a subset of a vector space closed under addition
and multiplication by a positive scalar, that is, $C + C\subseteq C$
and $tC\subseteq C$ for $t > 0$. Note the set of arbitrage
portfolios is a cone.

_Proof._ Since $C$ is closed and convex there exists $x^*\in C$ with
$0 < \|x^* - x\| \le \|y - x\|$ for all $y\in C$.  Let $\xi = x^* - x$.
For any $y\in C$ and $t > 0$ we have $ty + x^*\in C$ so $\|\xi\| \le \|ty + \xi\|$. 
Simplifying gives $t^2\|y\|^2 + 2t\xi^* y\ge 0$. 
Dividing by $t > 0$ and letting $t$ decrease to 0 shows $\xi^* y\ge 0$. 
Take $y = x^*$ then $tx^* + x^*\in C$ for $t \ge -1$. By similar reasoning,
letting $t$ increase to 0 shows $\xi^* x^*\le 0$ so $\xi^* x^* = 0$. 
Because $0 < \|\xi\|^2 = \xi^* (x^* - x) = -\xi^* x$ we have $\xi^* x < 0$.

Since the set of non-negative finitely additive measures is a closed
cone and $X\mapsto \int_\Omega X\,dD$ is positive, linear, and continuous
$C = \{\int_\Omega X\,dD : D\ge 0\}$ is also a closed cone.
The contrapositive follows from the lemma.

The proof also shows how to find an arbitrage when one exists.
-->
</section>
</body>
</html>
