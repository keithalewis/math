<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Keith A. Lewis" />
  <title>Option Pricing</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <link rel="stylesheet" href="math.css" />
  <script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
   var mathElements = document.getElementsByClassName("math");
   for (var i = 0; i < mathElements.length; i++) {
    var texText = mathElements[i].firstChild;
    if (mathElements[i].tagName == "SPAN") {
     katex.render(texText.data, mathElements[i], {
      displayMode: mathElements[i].classList.contains('display'),
      throwOnError: false,
      fleqn: true
     });
  }}});
  </script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <!--
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Literata:wght@300&display=swap" rel="stylesheet"> 
  <link href="https://fonts.googleapis.com/css2?family=Markazi+Text:wght@500&display=swap" rel="stylesheet"> 
  -->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Option Pricing</h1>
<p class="author">Keith A. Lewis</p>
</header>
<blockquote>
<p><em>Besides it is an error to believe that rigour is the enemy of simplicity. On the contrary we find it confirmed by numerous examples that the rigorous method is at the same time the simpler and the more easily comprehended. The very effort for rigor forces us to find out simpler methods of proof. — David Hilbert</em></p>
</blockquote>
<p>European <em>option valuation</em> involves calculating the expected value of the <em>option payoff</em> as a function of the <em>underlying</em> at <em>expiration</em>. <em>Greeks</em> are derivatives of the <em>value</em> with respect to <em>model parameters</em>. This short note derives formulas for these using any positive underlying distribution.</p>
<h2 id="share-measure">Share Measure</h2>
<p>Let <span class="math inline">Y</span> be the (random) price of some <em>underlying</em> instrument at option expiration. The (forward) <em>value</em> of an option paying <span class="math inline">\nu(Y)</span> in some currency at expiration is <span class="math inline">E[\nu(Y)]</span>. We can also consider the payoff in terms of shares of <span class="math inline">Y</span>, <span class="math inline">\nu_s(Y) = \nu(Y)Y/E[Y]</span>. If we receive <span class="math inline">\nu_s(Y)</span> shares of <span class="math inline">Y</span> at expiration we can convert those at price <span class="math inline">Y</span> to <span class="math inline">\nu(Y)</span> in the currency.</p>
<p>The <em>share measure</em> <span class="math inline">P_s</span> is defined by <span class="math inline">dP_s/dP = Y/E[Y]</span>. For example, the value of a put option paying <span class="math inline">\max\{k - Y,0\}</span> is <span class="math inline">p = E[(k - Y)1(Y\le k)] = kP(Y\le k) - E[Y] P_s(Y\le k)</span>.</p>
<h3 id="parameters">Parameters</h3>
<p>Let the <em>forward</em> be <span class="math inline">y = E[Y]</span> and the <em>vol</em> squared be <span class="math inline">s^2 = \operatorname{Var}(\log Y)</span>. Every positive random variable can be written <span class="math inline">Y = e^{m + sX}</span> for constants <span class="math inline">m</span>, <span class="math inline">s</span> and <span class="math inline">X</span> with mean 0 and variance 1. Using <span class="math inline">y = E[Y] = e^m e^{sX}</span> we see <span class="math inline">e^m = y e^{-\kappa(s)}</span> where <span class="math inline">\kappa(s) = \log E[e^{sX}]</span> is the <em>cumulant</em> of <span class="math inline">X</span>. The <em>greeks</em> are the values of the derivatives of value with respect to forward and vol. If you prefer a different parameterization <span class="math inline">y = y(z,t)</span>, <span class="math inline">s = s(z,t)</span> the chain rule can be applied to get greeks in terms of <span class="math inline">z</span> and <span class="math inline">t</span>.</p>
<p>Define <span class="math inline">\epsilon_s(x) = e^{s x - \kappa(s)}</span> so <span class="math inline">Y = y\epsilon_s(X)</span> and <span class="math inline">X = \epsilon_s^{-1}(Y/y)</span>. The <em>moneyness</em> of <span class="math inline">k</span> is <span class="math inline">x(k) = \epsilon_s^{-1}(k/y) = (\log k/y + \kappa(s))/s</span>. Note <span class="math inline">\partial \epsilon_s(x)/\partial x = \epsilon_s(x)s</span> and <span class="math inline">\partial \epsilon_s(x)/\partial s = \epsilon_s(x)(x - \kappa&#39;(s))</span>.</p>
<p>For any payoff <span class="math inline">\nu</span> and <span class="math inline">v = E[\nu(Y)]</span> we have <span class="math inline">\partial v/\partial y = E[\nu&#39;(Y)\partial Y/\partialy] = E_s[\nu&#39;(Y)]</span> since <span class="math inline">\partial Y/\partial y = \epsilon_s(X)</span>.</p>
<p><strong>Exercise</strong>. <em>Show <span class="math inline">\partial^nv/\partial y^n = E[\nu&#39;(Y)(\partial Y/\partial y)^n] = E_s[\nu^{(n)}(Y)Y^{n-1}]/y^{n-1}</span></em>, <span class="math inline">n\ge 1</span>.</p>
<p>For any payoff <span class="math inline">\nu</span> and <span class="math inline">v = E[\nu(Y)]</span> we have <span class="math inline">\partial v/\partial s = E[\nu&#39;(Y)\partial Y/\partial s] = E[\nu&#39;(Y)Y(X - \kappa&#39;(s))] = yE_s[\nu&#39;(Y)(X - \kappa&#39;(s))]</span> since <span class="math inline">\partial Y/\partial s = Y\epsilon_s(X)</span>.</p>
<p>The value and greeks of any option can be expressed in terms of derivatives of the cumulative distribution function <span class="math inline">\Psi_s(y) = P_s(Y\le y)</span> and those of <span class="math inline">\kappa(s)</span>.</p>
<p>Note <span class="math inline">\partial \Psi_0(y)/\partial s = E[-\delta_y(Y)Y(X - \kappa&#39;(s))] = -yE_s(\delta_y(Y)(X - \kappa&#39;(s))]</span>.</p>
<p><span class="math inline">\partial v/\partial s = E[\nu&#39;(Y)Y(X - \kappa&#39;(s))] = -E[\delta_k(Y)Y(X - \kappa&#39;(s))]</span></p>
<h2 id="parameters-1">Parameters</h2>
<p>Any positive random variable <span class="math inline">Y</span> can be parameterized using the <em>forward</em> <span class="math inline">f</span> and <em>vol</em> <span class="math inline">s</span> by <span class="math inline">Y = f e^{s X - κ(s)}</span>, where <span class="math inline">κ(s) = \log E[e^{s X}]</span> is the cumulant of <span class="math inline">X</span>. Note <span class="math inline">E[Y] = f</span> is the forward and <span class="math inline">\operatorname{Var}(\log Y) = s^2</span> is the vol squared if <span class="math inline">E[X] = 0</span> and <span class="math inline">E[X^2] = 1</span>, which we can, and do, assume.</p>
<p>For example, the Black model takes <span class="math inline">X</span> to be standard normal and vol <span class="math inline">s = σ \sqrt{t}</span> where <span class="math inline">σ</span> is the <em>volatilty</em> and <span class="math inline">t</span> is <em>time</em> in years to expiration. In this case <span class="math inline">Y = fe^{σ \sqrt{t} X - σ^2t/2}</span>.</p>
<h2 id="value-and-greeks">Value and Greeks</h2>
<p>Let <span class="math inline">X</span> be any random variable with mean 0 and variance 1 and define <span class="math inline">Y = fε_s(X)</span> where <span class="math inline">ε_s(x) = e^{sx - κ(s)}</span>. The <em>Esscher transform</em> <span class="math inline">X_s</span> of <span class="math inline">X</span> is defined by <span class="math inline">P(X_s\le x) = E[1(X\le x)ε_s(X)]</span> so <span class="math inline">E[g(X_s)] = E_s[g(X)] = E[g(X)ε_s(X)]</span> for any measurable function <span class="math inline">g</span>.</p>
<p>The (forward) <em>value</em> of an option paying <span class="math inline">ν(Y)</span> at expiration is <span class="math display">
v = E[ν(Y)].
</span></p>
<p><em>Delta</em> is the derivative of value with respect to forward <span class="math display">
    \frac{dv}{df} = E[ν&#39;(Y)dY/df] = E[ν&#39;(Y)Y/f] = E_s[ν&#39;(Y)].
</span></p>
<p><em>Gamma</em> is the second derivative of value with respect to forward <span class="math display">
    \frac{d^2v}{df^2} = \frac{d}{df} E[ν&#39;(Y)Y/f] = E[ν&#39;&#39;(Y)(Y/f)^2] = E_s[ν&#39;&#39;(Y)Y]/f
</span> since <span class="math inline">d(Y/f)/df = 0</span>.</p>
<p><strong>Exercise</strong>. <em>Show <span class="math inline">d^nv/df^n = E[ν^{(n)}(Y)(Y/f)^n] = E_s[ν^{(n)}(Y)Y^{n-1}]/f^{n-1}</span></em>.</p>
<p><em>Vega</em> is the derivative of value with respect to vol <span class="math display">
    \frac{dv}{ds} = E[ν&#39;(Y)dY/ds] = E[ν&#39;(Y)Y(X - κ&#39;(s))] = fE_s[ν&#39;(Y)(X - κ&#39;(s))].
</span></p>
<p>The inverse of option value as a function of vol is the <em>implied vol</em>.</p>
<h3 id="spot">Spot</h3>
<p>It is straightforward to convert these formulas to spot values and corresponding greeks. If the <em>spot price</em> of the underlying is <span class="math inline">u</span> the forward is <span class="math inline">f = e^{rt}u</span> where <span class="math inline">r</span> is the risk-free continuously compounded interest rate and <span class="math inline">t</span> is the time in years to expiration. The underlying at expiration is <span class="math inline">U = Y</span>.</p>
<p>The <em>spot value</em> is <span class="math inline">v_0 = e^{-rt}E[ν(U)]</span> and <em>spot delta</em> is <span class="math inline">dv_0/du = e^{-rt}E[ν&#39;(U) dU/du] = e^{-rt}E[ν&#39;(F) (dY/df) df/du] = e^{-rt}E[ν&#39;(F) (dY/df) e^{rt}] = dv/df</span>.</p>
<p>The spot and forward delta are equal but the spot gamma is <span class="math inline">d^2v_0/du^2 = d(dv/df)/du = (d^2v/df^2) df/du = e^{rt} d^2v/df^2</span>.</p>
<p><strong>Exercise</strong>. <em>Show <span class="math inline">d^nv_0/du^n = e^{(n-1)rt}d^nv/df^n</span></em>.</p>
<p>The spot vega is <span class="math inline">dv_0/ds = e^{-rt}E[ν&#39;(U) dU/ds] = e^{-rt}E[ν&#39;(Y) dY/ds] = e^{-rt}dv/ds</span>.</p>
<h3 id="distribution">Distribution</h3>
<p>If <span class="math inline">Φ(x)</span> is the cumulative distribution functions of <span class="math inline">X</span> then the cumulative distribution of <span class="math inline">Y</span> is <span class="math inline">Ψ(y) = Φ(x)</span> where <span class="math inline">y = y(x) = fε_s(x)</span> and <em>moneyness</em> <span class="math inline">x = x(y) = ε_s^{-1}(y/f) = (\log(y/f) + κ(s))/s</span>. Let <span class="math inline">ψ(y)</span> and <span class="math inline">φ(x)</span> be the corresponding density functions so <span class="math inline">ψ(y) = φ(x)dx/dy = φ(x)/ys</span> since <span class="math inline">dy/dx = ys</span>. Likewise, <span class="math inline">ψ_s(y) = φ_s(x)/ys</span>. Note <span class="math inline">φ_s(x) = φ(x)ε_s(x) = φ(x)y/f</span>. We collect these formulas for easy reference: <span class="math display">
\begin{aligned}
    y &amp;= y(x) = fε_s(x)\\
    x &amp;= x(y) = ε_s^{-1}(y/f) \\
    φ_s(x) &amp;= φ(x)ε_s(x) = φ(x)y/f \\
    ψ(y) &amp;= φ(x)/ys \\
    ψ_s(y) &amp;= φ_s(x)/ys = φ(x)/fs \\
\end{aligned}
</span> Note <span class="math inline">ψ_s&#39;(y) = φ&#39;(x)(dx/dy)/fs = φ&#39;(x)/yfs^2</span>.</p>
<p>We will also need the formula <span class="math display">
\frac{d}{ds}Φ_s(x) = \frac{d}{ds}E[1(X \le x)ε_s(X)] = E[1(X \le x)ε_s(X)(X - κ&#39;(s))]
</span> since <span class="math inline">dε_s(x)/ds = ε_s(x)(x - κ&#39;(s))</span>.</p>
<p>These are used in the formulas for put and call option values and their greeks.</p>
<h2 id="put-and-call">Put and Call</h2>
<p>A <em>put option</em> pays <span class="math inline">ν(Y) = (k - Y)^+ = \max\{k - Y,0\}</span> at expiration and has value <span class="math inline">p = E[(k - Y)^+]</span>. A <em>call option</em> pays <span class="math inline">ν(Y) = (Y - k)^+</span> at expiration and has value <span class="math inline">c = E[(Y - k)^+]</span>. Note <span class="math inline">(Y - k)^+ - (k - Y)^+ = Y - k</span> is a <em>forward</em> with <em>strike</em> <span class="math inline">k</span> so all models satisfy <em>put-call parity</em>: <span class="math inline">c - p = f - k</span>. Call delta is <span class="math inline">dc/df = dp/df + 1</span> and call gamma equals put gamma <span class="math inline">d^2c/df^2 = d^2p/df^2</span>. We also have <span class="math inline">dc/ds - dp/ds = 0</span> so call vega equals put vega.</p>
<p>Note <span class="math inline">Y \le y(x)</span> iff <span class="math inline">X \le x(y)</span> since <span class="math inline">dε_s(x)/dx &gt; 0</span>. The value of a put is <span class="math display">
\begin{aligned}
p &amp;= E[(k - Y)^+] \\
  &amp;= E[(k - Y)1(Y\le k)] \\
  &amp;= k P(Y \le k) - E[Y 1(Y \le k)] \\
  &amp;= k P(Y \le k) - fP_s(Y \le k) \\
  &amp;= k Φ(x(k)) - f Φ_s(x(k)). \\
\end{aligned}
</span></p>
<p>Put delta is <span class="math display">
    \frac{dp}{df} = -Φ_s(x(k)). 
</span></p>
<p>Gamma for either a put or call is <span class="math display">
    \frac{d^2p}{df^2} = E[δ_k(Y)(Y/f)^2] = ψ(k)(k/f)^2 = φ(x(k))k/f^2s = φ_s(x(k))/fs.
</span></p>
<p>Vega for a put is <span class="math display">
    \frac{dp}{ds} = -E[1(Y\le k)Y(X - κ&#39;(s))] = -f\frac{d}{ds}Φ_s(x(k)).
</span></p>
<h2 id="digital">Digital</h2>
<p>A <em>digital put</em> has payoff <span class="math inline">ν(Y) = 1(Y \le k)</span> and a <em>digital call</em> has payoff <span class="math inline">ν(Y) = 1(Y &gt; k)</span> with values <span class="math display">
    p = P(Y \le k) = Φ(x(k)),
    c = P(Y &gt; k) = 1 - Φ(x(k)).
</span></p>
<p>Digital put delta <span class="math display">
\begin{aligned}
    \frac{dp}{df} &amp;= -E[\delta_k(Y)(Y/f)] \\
    &amp;= -\psi(k)k/f \\
    &amp;= -(\phi(x(k)/fs)k/f \\
    &amp;= -\phi(x(k))k/f^2s \\
    &amp;= -\phi_s(x(k))/fs \\
\end{aligned}
</span></p>
<p>Digital gamma is <span class="math display">
\begin{aligned}
    \frac{d^2p}{df^2} &amp;= -E_s[\delta_k&#39;(Y)Y]/f \\
    &amp;= -\psi_s&#39;(k)k/f \\
    &amp;= -\phi&#39;(x(k))/f^2s^2
\end{aligned}
</span> where we use <span class="math inline">\psi_s(y) = \phi(x)/fs</span> so <span class="math inline">\psi_s&#39;(y) = \phi&#39;(x)/fks^2</span>.</p>
<p>Digital put vega is <span class="math display">
\begin{aligned}
\frac{dp}{ds} &amp;= -E_s[\delta_k(Y)Y(X - s)] \\
    &amp;= -\psi(k)k(x(k) - s) \\ 
    &amp;= -(\phi(x(k))/ks)k(x(k) - s) \\ 
    &amp;= -\phi(x(k))(x(k) - s)/s \\ 
\end{aligned}
</span></p>
<p>Since <span class="math inline">p + c = 1</span> we have <span class="math inline">d^nc/df^n = -d^np/df^n</span> and <span class="math inline">d^nc/ds^n = -d^np/ds^n</span> for all <span class="math inline">n &gt; 0</span>.</p>
<h2 id="black-model">Black Model</h2>
<p>We use the above to derive the standard Black-Scholes/Merton formulas for value and greeks. In the Black model <span class="math inline">Y = fe^{σB_t - σ^2t/2}</span> where <span class="math inline">f</span> is the forward, <span class="math inline">σ</span> is the volatility, and <span class="math inline">B_t</span> is Brownian motion at time <span class="math inline">t</span>. There is really no need to drag in Brownian motion to compute an option value, we only use the fact <span class="math inline">B_t</span> is normally distributed with mean <span class="math inline">0</span> and variance <span class="math inline">t</span>. There is also no need to drag in <span class="math inline">t</span>, let <span class="math inline">s = σ\sqrt{t}</span> and <span class="math inline">X</span> be standard normal so <span class="math inline">Y = fe^{sX - s^2/2}</span> has the same distribution.</p>
<p><a href="cdf.html#normal">Recall</a> if <span class="math inline">X</span> is standard normal then <span class="math inline">E[e^{μ + σ X}] = e^{μ + σ^2/2}</span> and <span class="math inline">E[g(X)e^{s X - s^2/2}] = E[g(X + s)]</span> for any function <span class="math inline">g</span> and <span class="math inline">s\in\bm{R}</span>. These formulas imply the cumulant of a standard normal is <span class="math inline">κ(s) = s^2/2</span> so <span class="math inline">Φ_s(x) = P_s(X\le x) = E[1(X\le x)e^{s X - s^2/2}] = P(X + s \le x) = Φ(x - s)</span> and <span class="math inline">φ_s(x) = φ(x - s)</span>. Note <span class="math inline">dΦ_s(x)/ds = -φ(x - s) = -φ_s(x)</span>.</p>
<p>Put value is <span class="math display">
    p = k Φ(x(k)) - f Φ(x(k) - s)
</span> where <span class="math inline">x(k) = \log(k/f)/s + s/2</span>.</p>
<p><strong>Exercise</strong>. <em>Show <span class="math inline">x(k) = \log(k/f)/s + s/2 = -d_2</span> and <span class="math inline">x(k) - s = \log(k/f)/s - s/2 = -d_1</span></em>.</p>
<p>Hint: The Black-Scholes/Merton formulas use <span class="math inline">d_1 = (\log(f/k) + s^2/2)/s</span> and <span class="math inline">d_2 = d_1 - s</span>.</p>
<p>Put delta is <span class="math display">
    \frac{dp}{df} = -Φ_s(x(k)) = -Φ(x(k) - s).
</span></p>
<p>Gamma is <span class="math display">
    \frac{d^2p}{df^2} = φ_s(x(k))/fs = φ(x(k))k/f^2s
</span></p>
<p>Vega is <span class="math display">
\begin{aligned}
    \frac{dv}{ds} &amp;= -E[1(Y\le k)Y(X - s)] \\
    &amp;= -f\frac{d}{ds}Φ_s(x(k)) \\
    &amp;= f(x(k) - s) = fφ_s(x(k)).
\end{aligned}
</span></p>
<p><span class="math inline">\langle\text{mic drop}/\rangle</span></p>
<footer>
Return to <a href="index.html">index</a>.
</footer>
</body>
</html>
