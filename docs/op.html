<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Keith A. Lewis" />
  <title>Option Pricing</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <link rel="stylesheet" href="math.css" />
  <script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
   var mathElements = document.getElementsByClassName("math");
   for (var i = 0; i < mathElements.length; i++) {
    var texText = mathElements[i].firstChild;
    if (mathElements[i].tagName == "SPAN") {
     katex.render(texText.data, mathElements[i], {
      displayMode: mathElements[i].classList.contains('display'),
      throwOnError: false,
      fleqn: true
     });
  }}});
  </script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <!--
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Literata:wght@300&display=swap" rel="stylesheet"> 
  <link href="https://fonts.googleapis.com/css2?family=Markazi+Text:wght@500&display=swap" rel="stylesheet"> 
  -->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Option Pricing</h1>
<p class="author">Keith A. Lewis</p>
</header>
<!--
> _Besides it is an error to believe that rigour is the enemy of simplicity. 
> On the contrary we find it confirmed by numerous examples that the rigorous 
> method is at the same time the simpler and the more easily comprehended. 
> The very effort for rigor forces us to find out simpler methods of proof. 
> &mdash; David Hilbert_
-->
<p>European <em>option valuation</em> involves calculating the expected value of the <em>option payoff</em> as a function of the <em>underlying</em> at <em>expiration</em>. <em>Greeks</em> are derivatives of the <em>value</em> with respect to <em>model parameters</em>. This short note derives formulas for these that can be used for any positive underlying.</p>
<p>In the Nobel Prize winning theory of Black, Scholes, and Merton the value of an option is ‚Ä¶</p>
<p>The option delta is the derivative of the value with respect to the underlying, <span class="math inline">\partial_s v = ...</span>. The naive derivative gives the correct answer, but <span class="math inline">d_1</span> and <span class="math inline">d_2</span> depend on <span class="math inline">s</span> so the mathematically correct derivative is ‚Ä¶</p>
<p>Every positive random variable <span class="math inline">F</span> can be parameterized as <span class="math inline">F = fe^{sX - \kappa(s)}</span> where <span class="math inline">f = E[F]</span> is the <em>forward</em>, <span class="math inline">s^2 = \operatorname{Var}[\log F]</span> is the <em>vol</em> squared, and <span class="math inline">Œ∫(s) = \log E[e^{sX}]</span> is the <em>cumulant</em> of <span class="math inline">X</span>. Define the <em>partial cumulant</em> <span class="math inline">Œ∫(x,s) = \log E[1(X\le x) e^{sX}]</span>. Call and put values and their greeks can be expressed in terms of the partial cumulant and its derivatives.</p>
<section id="share-measure" class="level2">
<h2>Share Measure</h2>
<p>Let <span class="math inline">F</span> be the positive, random price of some <em>underlying</em> instrument at option expiration. The (forward) <em>value</em> of an option paying <span class="math inline">ŒΩ(F)</span> in some currency at expiration is <span class="math inline">E[ŒΩ(F)] = \int ŒΩ(F)\,dP</span>. We can also consider the payoff in terms of shares of <span class="math inline">F</span>, <span class="math inline">ŒΩ_s(F) = ŒΩ(F)F/E[F]</span>. If we receive <span class="math inline">ŒΩ_s(F)</span> shares of <span class="math inline">F</span> at expiration we can convert those at price <span class="math inline">F</span> to <span class="math inline">ŒΩ(F)</span> in the currency.</p>
<p><em>Share measure</em> <span class="math inline">P_s</span> is defined by <span class="math inline">dP_s/dP = F/E[F]</span>. We write <span class="math inline">E_s</span> for expectation under the share measure. Note <span class="math inline">F &gt; 0</span> and <span class="math inline">E_s[1] = 1</span> so share measure is a probability measure.</p>
</section>
<section id="parameters" class="level2">
<h2>Parameters</h2>
<p>The <em>forward</em> is <span class="math inline">f = E[F]</span> and the <em>vol</em> squared is <span class="math inline">s^2 = \operatorname{Var}(\log F)</span>. Every positive random variable can be written <span class="math inline">F = e^{m + sX}</span> for constants <span class="math inline">m</span>, <span class="math inline">s</span> and <span class="math inline">X</span> having mean 0 and variance 1. Using <span class="math inline">f = E[F] = e^m E[e^{sX}]</span> we see <span class="math inline">e^m = f e^{-Œ∫(s)}</span> where <span class="math inline">Œ∫(s) = \log E[e^{sX}]</span> is the <em>cumulant</em> of <span class="math inline">X</span>. Hence <span class="math inline">F = fe^{sX - Œ∫(s)}</span> is parameterized by <span class="math inline">f</span>, <span class="math inline">s</span>, and a mean 0 variance 1 random variable <span class="math inline">X</span>. <em>Greeks</em> are the derivatives of value with respect to forward and vol.</p>
<p>If you prefer a different parameterization, say <span class="math inline">f = f(u,t)</span>, <span class="math inline">s = s(u,t)</span>, the chain rule can be applied to get greeks in terms of <span class="math inline">u</span> and <span class="math inline">t</span>. For example, the Black model takes <span class="math inline">X</span> to be standard normal and vol <span class="math inline">s = œÉ \sqrt{t}</span> where <span class="math inline">œÉ</span> is the <em>volatilty</em> and <span class="math inline">t</span> is <em>time</em> in years to expiration. In this case <span class="math inline">F = fe^{œÉ\sqrt{t} X - œÉ^2t/2}</span> and <span class="math inline">‚àÇ_œÉ E[ŒΩ(F)] = ‚àÇ_sE[ŒΩ(F)] ‚àÇs/‚àÇœÉ = ‚àÇ_sE[ŒΩ(F)]\sqrt{t}</span>.</p>
</section>
<section id="greeks" class="level2">
<h2>Greeks</h2>
<p>Define <span class="math inline">Œµ_s(x) = e^{s x - Œ∫(s)}</span> so <span class="math inline">‚àÇ_x Œµ_s(x) = Œµ_s(x)s</span> and <span class="math inline">‚àÇ_s Œµ_s(x) = Œµ_s(x)(x - Œ∫&#39;(s))</span>.</p>
<p>For any payoff <span class="math inline">ŒΩ</span> the <em>value</em> is <span class="math inline">v = E[ŒΩ(F)]</span> and <em>delta</em> is the derivative of value with respect to the forward <span class="math display">
‚àÇ_f v
    = E[ŒΩ&#39;(F) ‚àÇ_f F]
    = E[ŒΩ&#39;(F)Œµ_s(X)]
    = E_s[ŒΩ&#39;(F)]
</span> since <span class="math inline">‚àÇ_f F = Œµ_s(X)</span>.</p>
<p><em>Gamma</em> is the second derivative with respect to the forward <span class="math display">
‚àÇ_f^2 v = E[ŒΩ&#39;&#39;(F)Œµ_s^2(X)] = E_s[ŒΩ&#39;&#39;(F)Œµ_s(X)]
</span></p>
<p><em>Vega</em> is the derivative with respect to vol <span class="math display">
‚àÇ_s v = E[ŒΩ&#39;(F) ‚àÇ_s F] = E[ŒΩ&#39;(F)F(X - Œ∫&#39;(s))] = f E_s[ŒΩ&#39;(F)(X - Œ∫&#39;(s))]
</span> since <span class="math inline">‚àÇ_s F = F(X - Œ∫&#39;(s))</span>.</p>
<p>The inverse of option value as a function of vol is the <em>implied vol</em>.</p>
<section id="distribution" class="level3">
<h3>Distribution</h3>
<p>Let <span class="math inline">Œ¶(x) = P(X\le x)</span> be the cumulative distribution functions of <span class="math inline">X</span> and <span class="math inline">Œ¶_s(x) = P_s(X\le x) = E[1(X\le x)Œµ_s(X)]</span> be the <em>share</em> cdf where <span class="math inline">Œµ_s(x) = e^{sx - Œ∫(s)}</span>. Note <span class="math inline">Œ¶_s(x) = \exp(Œ∫(x,s))</span> can be written in terms of the partial cumulant. Since <span class="math inline">œÜ_s(x) = Œ¶_s&#39;(x) = œÜ(x) Œµ_s(x)</span> we have <span class="math display">
‚àÇ_s Œ¶_s(x) = E[1(X\le x)Œµ_s(X)(X - Œ∫&#39;(s))].
</span></p>
<p>Let <span class="math inline">y = y(x) = fŒµ_s(x)</span>. The <em>moneyness</em> of <span class="math inline">y</span> is <span class="math inline">x = x(y) = Œµ_s^{-1}(y/f) = (\log y/f + Œ∫(s))/s</span>. Note <span class="math inline">F = fŒµ_s(X)</span> and <span class="math inline">dP_s = Œµ_s(X)\,dP</span> is share measure.</p>
<p>We have <span class="math inline">F \le y(x)</span> if and only if <span class="math inline">X \le x(y)</span>, where <span class="math inline">x = x(y) = Œµ_s^{-1}(y/f)</span>, since <span class="math inline">‚àÇ_x Œµ_s(x) &gt; 0</span> (assuming <span class="math inline">s &gt; 0</span>). The cumulative distribution of <span class="math inline">F</span> is <span class="math inline">Œ®(y) = P(F\le y) = P(X\le x) = Œ¶(x)</span> and the density function of <span class="math inline">F</span> is <span class="math inline">œà(y) = Œ®&#39;(y) = Œ¶&#39;(x) dx/dy = œÜ(x)/ys</span> since <span class="math inline">dy/dx = ys</span>. Note <span class="math display">
    œà&#39;(y) = \frac{œÜ&#39;(x) - œÜ(x)s}{y^2s^2}. 
</span></p>
<!--
Let $œà(y)$ and $œÜ(x)$ be the corresponding density functions so
$œà(y) = œÜ(x)dx/dy = œÜ(x)/ys$ since $dy/dx = ys$.
Likewise, $œà_s(y) = œÜ_s(x)/ys$.
Note $œÜ_s(x) = œÜ(x)Œµ_s(x) = œÜ(x)y/f$.
We collect these formulas for easy reference:
$$
\begin{aligned}
    y &= y(x) = fŒµ_s(x)\\
    x &= x(y) = Œµ_s^{-1}(y/f) \\
    œÜ_s(x) &= œÜ(x)Œµ_s(x) = œÜ(x)y/f \\
    œà(y) &= œÜ(x)/ys \\
    œà_s(y) &= œÜ_s(x)/ys = œÜ(x)/fs \\
\end{aligned}
$$
Note $œà_s'(y) = œÜ'(x)(dx/dy)/fs = œÜ'(x)/yfs^2$.
-->
</section>
</section>
<section id="put-and-call" class="level2">
<h2>Put and Call</h2>
<p>A <em>put option</em> pays <span class="math inline">ŒΩ(F) = (k - F)^+ = \max\{k - F,0\}</span> at expiration and has value <span class="math inline">p = E[(k - F)^+]</span>. A <em>call option</em> pays <span class="math inline">ŒΩ(F) = (F - k)^+</span> at expiration and has value <span class="math inline">c = E[(F - k)^+]</span>. Note <span class="math inline">(F - k)^+ - (k - F)^+ = F - k</span> is a <em>forward</em> with <em>strike</em> <span class="math inline">k</span> so all models satisfy <em>put-call parity</em>: <span class="math inline">c - p = f - k</span>. Call delta is <span class="math inline">‚àÇc/‚àÇf = ‚àÇp/‚àÇf + 1</span> and call gamma equals put gamma <span class="math inline">‚àÇ^2c/‚àÇf^2 = ‚àÇ^2p/‚àÇf^2</span>. We also have <span class="math inline">‚àÇc/‚àÇs - ‚àÇp/‚àÇs = 0</span> so call vega equals put vega.</p>
<p>The value of a put is <span class="math display">
\begin{aligned}
p &amp;= E[(k - F)^+] \\
  &amp;= E[(k - F)1(F\le k)] \\
  &amp;= k P(F \le k) - E[F 1(F \le k)] \\
  &amp;= k P(F \le k) - fP_s(F \le k) \\
  &amp;= k Œ¶(x(k)) - f Œ¶_s(x(k)). \\
\end{aligned}
</span></p>
<p>Put delta is <span class="math display">
    ‚àÇ_f p = E[-1(F\le k)Œµ_s(X)] = -P_s(X\le x(k)) = -Œ¶_s(x(k)). 
</span></p>
<p>Gamma for either a put or call is <span class="math display">
    ‚àÇ_f^2 p = E[Œ¥_k(F)(F/f)^2] = œà(k)(k/f)^2 = œÜ(x(k))k/f^2s = œÜ_s(x(k))/fs.
</span></p>
<p>Vega for a put is <span class="math display">
    ‚àÇ_s p = -E[1(F\le k)F(X - Œ∫&#39;(s))] = -f ‚àÇ_s Œ¶_s(x(k)).
</span></p>
</section>
<section id="digital" class="level2">
<h2>Digital</h2>
<p>A <em>digital put</em> has payoff <span class="math inline">ŒΩ(F) = 1(F \le k)</span> and a <em>digital call</em> has payoff <span class="math inline">ŒΩ(F) = 1(F &gt; k)</span> with values <span class="math display">
    p = P(F \le k) = Œ¶(x(k)),
    c = P(F &gt; k) = 1 - Œ¶(x(k)).
</span></p>
<p>Digital put delta <span class="math display">
\begin{aligned}
    ‚àÇ_f p &amp;= -E[\delta_k(F)(F/f)] \\
    &amp;= -œà(k)k/f \\
    &amp;= -(œÜ(x(k)/ks)k/f \\
    &amp;= -œÜ(x(k))/fs \\
    &amp;= -œÜ_s(x(k))/ks \\
\end{aligned}
</span></p>
<p>Digital gamma is <span class="math display">
\begin{aligned}
    ‚àÇ_f^2 p &amp;= -E[\delta_k&#39;(F)(F/f)^2] \\
    &amp;= -œà&#39;(k)(k/f)^2 \\
    &amp;= -((œÜ&#39;(x(k)) - œÜ(x(k))s)/k^2s^2))(k/f)^2 \\
    &amp;= -(œÜ&#39;(x(k)) - œÜ(x(k))s)/f^2s^2) \\
\end{aligned}
</span></p>
<p>Digital put vega is <span class="math display">
\begin{aligned}
‚àÇ_s p &amp;= -E_s[\delta_k(F)F(X - s)] \\
    &amp;= -œà(k)k(x(k) - s) \\ 
    &amp;= -(œÜ(x(k))/ks)k(x(k) - s) \\ 
    &amp;= -œÜ(x(k))(x(k) - s)/s \\ 
\end{aligned}
</span></p>
</section>
<section id="black-model" class="level2">
<h2>Black Model</h2>
<p>We use the above to derive the standard Black-Scholes/Merton formulas for value and greeks. In the Black model <span class="math inline">F = fe^{œÉB_t - œÉ^2t/2}</span> where <span class="math inline">f</span> is the forward, <span class="math inline">œÉ</span> is the volatility, and <span class="math inline">B_t</span> is Brownian motion at time <span class="math inline">t</span>. There is really no need to drag in Brownian motion to compute an option value, we only use the fact <span class="math inline">B_t</span> is normally distributed with mean <span class="math inline">0</span> and variance <span class="math inline">t</span>. There is also no need to drag in <span class="math inline">t</span>, let <span class="math inline">s = œÉ\sqrt{t}</span> and <span class="math inline">X</span> be standard normal so <span class="math inline">F = fe^{sX - s^2/2}</span> has the same distribution.</p>
<p><a href="cdf.html#normal">Recall</a> if <span class="math inline">X</span> is standard normal then <span class="math inline">E[e^{Œº + œÉ X}] = e^{Œº + œÉ^2/2}</span> and <span class="math inline">E[g(X)e^{s X - s^2/2}] = E[g(X + s)]</span> for any function <span class="math inline">g</span> and <span class="math inline">s\in ùëπ</span>. These formulas imply the cumulant of a standard normal is <span class="math inline">Œ∫(s) = s^2/2</span> and <span class="math inline">Œ¶_s(x) = P_s(X\le x) = E[1(X\le x)e^{s X - s^2/2}] = P(X + s \le x) = Œ¶(x - s)</span>. Note <span class="math inline">œÜ_s(x) = œÜ(x - s)</span> and <span class="math inline">‚àÇŒ¶_s(x)/‚àÇs = -œÜ(x - s) = -œÜ_s(x)</span>.</p>
<p>Put value is <span class="math display">
    p = k Œ¶(x(k)) - f Œ¶(x(k) - s)
</span> where <span class="math inline">x(k) = \log(k/f)/s + s/2</span>.</p>
<p><strong>Exercise</strong>. <em>Show <span class="math inline">x(k) = \log(k/f)/s + s/2 = -d_2</span> and <span class="math inline">x(k) - s = \log(k/f)/s - s/2 = -d_1</span></em>.</p>
<p>Hint: The Black-Scholes/Merton formulas use <span class="math inline">d_1 = (\log(f/k) + s^2/2)/s</span> and <span class="math inline">d_2 = d_1 - s</span>.</p>
<p>Put delta is <span class="math display">
    ‚àÇ_f p = -Œ¶_s(x(k)) = -Œ¶(x(k) - s).
</span></p>
<p>Gamma is <span class="math display">
    ‚àÇ_f^2 p = œÜ(x(k))k/f^2s = œÜ_s(x(k))/fs.
</span></p>
<p>Vega is <span class="math display">
\begin{aligned}
    ‚àÇ_s v &amp;= -f ‚àÇ_s Œ¶_s(x(k)) \\
    &amp;= fœÜ(x(k) - s) = fœÜ_s(x(k)).
\end{aligned}
</span></p>
</section>
<section id="spot" class="level2">
<h2>Spot</h2>
<p>The Black-Merton/Scholes model uses <em>spot</em> prices instead of forward. If a risk-free bond has realized return <span class="math inline">R</span> over the period the value of the underlying at expiration is <span class="math inline">U = Rue^{sX - Œ∫(s)}</span>. Since <span class="math inline">F = U</span> we have <span class="math inline">f = Ru</span>. The <em>spot</em> value of the option is <span class="math inline">v_0 = E[ŒΩ(U)]/R</span>. We have <span class="math display">
‚àÇ_u v_0 = E[ŒΩ&#39;(U) ‚àÇ_u U]/R
= E[ŒΩ&#39;(F) ‚àÇ_f F ‚àÇ_u f]/R
= E[ŒΩ&#39;(F) ‚àÇ_f F R]/R = ‚àÇ_f v.
</span> Spot and forward delta are equal but the spot gamma is <span class="math display">
‚àÇ_u^2 v_0 = ‚àÇ_u ‚àÇ_f v = ‚àÇ_f^2 v ‚àÇ_u f = ‚àÇ_f^2 v R.
</span> Spot vega is <span class="math display">
‚àÇ_s v_0 = E[ŒΩ&#39;(U) ‚àÇ_s U]/R = E[ŒΩ&#39;(F) ‚àÇ_s F/R = ‚àÇ_s v/R.
</span></p>
</section>
<section id="remarks" class="level2">
<h2>Remarks</h2>
<p>Let <span class="math inline">X</span> have cdf <span class="math inline">Œ¶(x) = P(X\le x)</span> and pdf <span class="math inline">œÜ(x) = Œ¶&#39;(x)</span>. <span class="math display">
    K(s,x) = E[1(X\le x) e^{sX}], K(s) = E[e^{sX}]
</span> be the partial, moment generating function and <span class="math inline">Œ∫(s,x) = \log K(s,x)</span>, <span class="math inline">Œ∫(s) = \log K(s)</span> be the partial, cumulant generating function of <span class="math inline">X</span>.</p>
<p>Let <span class="math inline">Œµ_s(x) = e^{sx}/K(s) = e^{sx - Œ∫(s)}</span>.</p>
<p>If <span class="math inline">X</span> is standard normal <span class="math inline">K(s,x) = e^{s^2/2}Œ¶(x - s)</span> and <span class="math inline">K(s) = e^{s^2/2}</span>.</p>
<p><span class="math inline">Œ¶_s(x) = K(s,x)/K(s)</span>. If <span class="math inline">X</span> is standard normal <span class="math inline">Œ¶_s(x) = Œ¶(x - s)</span>.</p>
<p><span class="math inline">‚àÇ_x K(s,x) = E[Œ¥_x(X) e^{sX}] = e^{sx} œÜ(x)</span></p>
<p><span class="math inline">‚àÇ_x Œ¶_s(x) = e^{sx} œÜ(x)/K(s) = e^{sx - Œ∫(s)} œÜ(x)</span>.</p>
<p><span class="math inline">‚àÇ_x^{n+1} Œ¶_s(x) = e^{sx - Œ∫(s)}\sum_{k=0}^n \binom{n}{k} œÜ^{(n - k)}(x) s^k</span>.</p>
<p><span class="math inline">‚àÇ_s^n K(s,x) = E[1(X\le x) e^{sX} X^n]</span>, <span class="math inline">‚àÇ_s^n K(s) = E[e^{sX} X^n]</span>.</p>
<p><span class="math inline">‚àÇ_s Œ¶_s(x) = (K(s)‚àÇ_s K(s, x) - ‚àÇ_s K(s) K(s, x))/K(s)^2</span>.</p>
<p><span class="math display">
\begin{aligned}
‚àÇ_x^2 K(s,x) &amp;= s(sK(s,x) + e^{sx} œÜ(x)) + e^{sx}s œÜ(x) + e^{sx}œÜ&#39;(x) \\
    &amp;= s^2 K(s,x) + e^{sx} (2s œÜ(x) + œÜ&#39;(x)\\
\end{aligned}
</span></p>
<p><span class="math display">
\begin{aligned}
‚àÇ_x^3 K(s,x) &amp;= s^2 (s K(s,x) + e^{sx}œÜ(x)) + e^{sx}s(2 œÜ(x) + œÜ&#39;(x)) + e^{sx}(2 œÜ&#39;(x) + œÜ&#39;&#39;(x))\\
    &amp;= s^3 K(s,x) + e^{sx} (3s^2 œÜ(x) + 3œÜ&#39;(x) + œÜ&#39;&#39;(x))\\
\end{aligned}
</span></p>
<p>and <span class="math inline">K(x, s) = \exp(Œ∫(x,s)) = Œ¶_s(x)</span>. We have <span class="math inline">œÜ_s(x) = ‚àÇ_x Œ¶_s(x) = K_x(x, s) = K(x, s)‚àÇ_x Œ∫(x,s)</span>.</p>
<p><span class="math display">
\begin{aligned}
Œ∫_{a + bX}(x,s) &amp;= \log E[1(a + bX \le x) e^{s(a + bX)}] \\
    &amp;= \log e^{as} E[1(X \le (x - a)/b) e^{sbX}] \\
    &amp;= as + Œ∫_X((x - a)/b, bs) \\
\end{aligned}
</span></p>
</section>
<footer>
Return to <a href="index.html">index</a>.
</footer>
</body>
</html>
