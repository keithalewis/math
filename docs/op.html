<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Keith A. Lewis" />
  <title>Option Pricing</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <link rel="stylesheet" href="math.css" />
  <script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
   var mathElements = document.getElementsByClassName("math");
   for (var i = 0; i < mathElements.length; i++) {
    var texText = mathElements[i].firstChild;
    if (mathElements[i].tagName == "SPAN") {
     katex.render(texText.data, mathElements[i], {
      displayMode: mathElements[i].classList.contains('display'),
      throwOnError: false,
      fleqn: true
     });
  }}});
  </script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <!--
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Literata:wght@300&display=swap" rel="stylesheet"> 
  <link href="https://fonts.googleapis.com/css2?family=Markazi+Text:wght@500&display=swap" rel="stylesheet"> 
  -->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Option Pricing</h1>
<p class="author">Keith A. Lewis</p>
</header>
<!--
> _Besides it is an error to believe that rigour is the enemy of simplicity. 
> On the contrary we find it confirmed by numerous examples that the rigorous 
> method is at the same time the simpler and the more easily comprehended. 
> The very effort for rigor forces us to find out simpler methods of proof. 
> &mdash; David Hilbert_
-->
<p>European <em>option valuation</em> involves calculating the expected value of the <em>option payoff</em> as a function of the <em>underlying</em> at <em>expiration</em>. <em>Greeks</em> are derivatives of the <em>value</em> with respect to <em>model parameters</em>. This short note derives formulas for these that can be used for any positive underlying.</p>
<p>Every positive random variable <span class="math inline">F</span> can be parameterized as <span class="math inline">F = fe^{sX - \kappa(s)}</span> where <span class="math inline">f = E[F]</span> is the <em>forward</em>, <span class="math inline">s^2 = \operatorname{Var}[\log F]</span> is the <em>vol</em> squared, and <span class="math inline">Îº(s) = \log E[e^{sX}]</span> is the <em>cumulant</em> of <span class="math inline">X</span>. Define the <em>partial cumulant</em> <span class="math inline">Îº(x,s) = \log E[1(X\le x) e^{sX}]</span>. Call and put values and their greeks can be expressed in terms of the partial cumulant and its derivatives.</p>
<section id="share-measure" class="level2">
<h2>Share Measure</h2>
<p>Let <span class="math inline">F</span> be the positive, random price of some <em>underlying</em> instrument at option expiration. The (forward) <em>value</em> of an option paying <span class="math inline">Î½(F)</span> in some currency at expiration is <span class="math inline">E[Î½(F)] = \int Î½(F)\,dP</span>. We can also consider the payoff in terms of shares of <span class="math inline">F</span>, <span class="math inline">Î½_s(F) = Î½(F)F/E[F]</span>. If we receive <span class="math inline">Î½_s(F)</span> shares of <span class="math inline">F</span> at expiration we can convert those at price <span class="math inline">F</span> to <span class="math inline">Î½(F)</span> in the currency.</p>
<p><em>Share measure</em> <span class="math inline">P_s</span> is defined by <span class="math inline">dP_s/dP = F/E[F]</span>. We write <span class="math inline">E_s</span> for expectation under the share measure. Note <span class="math inline">F &gt; 0</span> and <span class="math inline">E_s[1] = 1</span> so share measure is a probability measure.</p>
</section>
<section id="parameters" class="level2">
<h2>Parameters</h2>
<p>The <em>forward</em> is <span class="math inline">f = E[F]</span> and the <em>vol</em> squared is <span class="math inline">s^2 = \operatorname{Var}(\log F)</span>. Every positive random variable can be written <span class="math inline">F = e^{m + sX}</span> for constants <span class="math inline">m</span>, <span class="math inline">s</span> and <span class="math inline">X</span> having mean 0 and variance 1. Using <span class="math inline">f = E[F] = e^m E[e^{sX}]</span> we see <span class="math inline">e^m = f e^{-Îº(s)}</span> where <span class="math inline">Îº(s) = \log E[e^{sX}]</span> is the <em>cumulant</em> of <span class="math inline">X</span>. Hence <span class="math inline">F = fe^{sX - Îº(s)}</span> is parameterized by <span class="math inline">f</span>, <span class="math inline">s</span>, and a mean 0 variance 1 random variable <span class="math inline">X</span>. <em>Greeks</em> are the derivatives of value with respect to forward and vol.</p>
<p>If you prefer a different parameterization, say <span class="math inline">f = f(u,t)</span>, <span class="math inline">s = s(u,t)</span>, the chain rule can be applied to get greeks in terms of <span class="math inline">u</span> and <span class="math inline">t</span>. For example, the Black model takes <span class="math inline">X</span> to be standard normal and vol <span class="math inline">s = Ïƒ \sqrt{t}</span> where <span class="math inline">Ïƒ</span> is the <em>volatilty</em> and <span class="math inline">t</span> is <em>time</em> in years to expiration. In this case <span class="math inline">F = fe^{Ïƒ\sqrt{t} X - Ïƒ^2t/2}</span> and <span class="math inline">âˆ‚_Ïƒ E[Î½(F)] = âˆ‚_sE[Î½(F)] âˆ‚s/âˆ‚Ïƒ = âˆ‚_sE[Î½(F)]\sqrt{t}</span>.</p>
</section>
<section id="greeks" class="level2">
<h2>Greeks</h2>
<p>Define <span class="math inline">Îµ_s(x) = e^{s x - Îº(s)}</span> so <span class="math inline">âˆ‚_x Îµ_s(x) = Îµ_s(x)s</span> and <span class="math inline">âˆ‚_s Îµ_s(x) = Îµ_s(x)(x - Îº&#39;(s))</span>.</p>
<p>For any payoff <span class="math inline">Î½</span> the <em>value</em> is <span class="math inline">v = E[Î½(F)]</span> and <em>delta</em> is the derivative of value with respect to the forward <span class="math display">
âˆ‚_f v
    = E[Î½&#39;(F) âˆ‚_f F]
    = E[Î½&#39;(F)Îµ_s(X)]
    = E_s[Î½&#39;(F)]
</span> since <span class="math inline">âˆ‚_f F = Îµ_s(X)</span>.</p>
<p><em>Gamma</em> is the second derivative with respect to the forward <span class="math display">
âˆ‚_f^2 v = E[Î½&#39;&#39;(F)Îµ_s^2(X)] = E_s[Î½&#39;&#39;(F)Îµ_s(X)]
</span></p>
<p><em>Vega</em> is the derivative with respect to vol <span class="math display">
âˆ‚_s v = E[Î½&#39;(F) âˆ‚_s F] = E[Î½&#39;(F)F(X - Îº&#39;(s))] = f E_s[Î½&#39;(F)(X - Îº&#39;(s))]
</span> since <span class="math inline">âˆ‚_s F = F(X - Îº&#39;(s))</span>.</p>
<p>The inverse of option value as a function of vol is the <em>implied vol</em>.</p>
<section id="distribution" class="level3">
<h3>Distribution</h3>
<p>Let <span class="math inline">Î¦(x) = P(X\le x)</span> be the cumulative distribution functions of <span class="math inline">X</span> and <span class="math inline">Î¦_s(x) = P_s(X\le x) = E[1(X\le x)Îµ_s(X)]</span> be the <em>share</em> cdf where <span class="math inline">Îµ_s(x) = e^{sx - Îº(s)}</span>. Note <span class="math inline">Î¦_s(x) = \exp(Îº(x,s))</span> can be written in terms of the partial cumulant. Since <span class="math inline">Ï†_s(x) = Î¦_s&#39;(x) = Ï†(x) Îµ_s(x)</span> we have <span class="math display">
âˆ‚_s Î¦_s(x) = E[1(X\le x)Îµ_s(X)(X - Îº&#39;(s))].
</span></p>
<p>Let <span class="math inline">y = y(x) = fÎµ_s(x)</span>. The <em>moneyness</em> of <span class="math inline">y</span> is <span class="math inline">x = x(y) = Îµ_s^{-1}(y/f) = (\log y/f + Îº(s))/s</span>. Note <span class="math inline">F = fÎµ_s(X)</span> and <span class="math inline">dP_s = Îµ_s(X)\,dP</span> is share measure.</p>
<p>We have <span class="math inline">F \le y(x)</span> if and only if <span class="math inline">X \le x(y)</span>, where <span class="math inline">x = x(y) = Îµ_s^{-1}(y/f)</span>, since <span class="math inline">âˆ‚_x Îµ_s(x) &gt; 0</span> (assuming <span class="math inline">s &gt; 0</span>). The cumulative distribution of <span class="math inline">F</span> is <span class="math inline">Î¨(y) = P(F\le y) = P(X\le x) = Î¦(x)</span> and the density function of <span class="math inline">F</span> is <span class="math inline">Ïˆ(y) = Î¨&#39;(y) = Î¦&#39;(x) dx/dy = Ï†(x)/ys</span> since <span class="math inline">dy/dx = ys</span>. Note <span class="math display">
    Ïˆ&#39;(y) = \frac{Ï†&#39;(x) - Ï†(x)s}{y^2s^2}. 
</span></p>
<!--
Let $Ïˆ(y)$ and $Ï†(x)$ be the corresponding density functions so
$Ïˆ(y) = Ï†(x)dx/dy = Ï†(x)/ys$ since $dy/dx = ys$.
Likewise, $Ïˆ_s(y) = Ï†_s(x)/ys$.
Note $Ï†_s(x) = Ï†(x)Îµ_s(x) = Ï†(x)y/f$.
We collect these formulas for easy reference:
$$
\begin{aligned}
    y &= y(x) = fÎµ_s(x)\\
    x &= x(y) = Îµ_s^{-1}(y/f) \\
    Ï†_s(x) &= Ï†(x)Îµ_s(x) = Ï†(x)y/f \\
    Ïˆ(y) &= Ï†(x)/ys \\
    Ïˆ_s(y) &= Ï†_s(x)/ys = Ï†(x)/fs \\
\end{aligned}
$$
Note $Ïˆ_s'(y) = Ï†'(x)(dx/dy)/fs = Ï†'(x)/yfs^2$.
-->
</section>
</section>
<section id="put-and-call" class="level2">
<h2>Put and Call</h2>
<p>A <em>put option</em> pays <span class="math inline">Î½(F) = (k - F)^+ = \max\{k - F,0\}</span> at expiration and has value <span class="math inline">p = E[(k - F)^+]</span>. A <em>call option</em> pays <span class="math inline">Î½(F) = (F - k)^+</span> at expiration and has value <span class="math inline">c = E[(F - k)^+]</span>. Note <span class="math inline">(F - k)^+ - (k - F)^+ = F - k</span> is a <em>forward</em> with <em>strike</em> <span class="math inline">k</span> so all models satisfy <em>put-call parity</em>: <span class="math inline">c - p = f - k</span>. Call delta is <span class="math inline">âˆ‚c/âˆ‚f = âˆ‚p/âˆ‚f + 1</span> and call gamma equals put gamma <span class="math inline">âˆ‚^2c/âˆ‚f^2 = âˆ‚^2p/âˆ‚f^2</span>. We also have <span class="math inline">âˆ‚c/âˆ‚s - âˆ‚p/âˆ‚s = 0</span> so call vega equals put vega.</p>
<p>The value of a put is <span class="math display">
\begin{aligned}
p &amp;= E[(k - F)^+] \\
  &amp;= E[(k - F)1(F\le k)] \\
  &amp;= k P(F \le k) - E[F 1(F \le k)] \\
  &amp;= k P(F \le k) - fP_s(F \le k) \\
  &amp;= k Î¦(x(k)) - f Î¦_s(x(k)). \\
\end{aligned}
</span></p>
<p>Put delta is <span class="math display">
    âˆ‚_f p = E[-1(F\le k)Îµ_s(X)] = -P_s(X\le x(k)) = -Î¦_s(x(k)). 
</span></p>
<p>Gamma for either a put or call is <span class="math display">
    âˆ‚_f^2 p = E[Î´_k(F)(F/f)^2] = Ïˆ(k)(k/f)^2 = Ï†(x(k))k/f^2s = Ï†_s(x(k))/fs.
</span></p>
<p>Vega for a put is <span class="math display">
    âˆ‚_s p = -E[1(F\le k)F(X - Îº&#39;(s))] = -f âˆ‚_s Î¦_s(x(k)).
</span></p>
</section>
<section id="digital" class="level2">
<h2>Digital</h2>
<p>A <em>digital put</em> has payoff <span class="math inline">Î½(F) = 1(F \le k)</span> and a <em>digital call</em> has payoff <span class="math inline">Î½(F) = 1(F &gt; k)</span> with values <span class="math display">
    p = P(F \le k) = Î¦(x(k)),
    c = P(F &gt; k) = 1 - Î¦(x(k)).
</span></p>
<p>Digital put delta <span class="math display">
\begin{aligned}
    âˆ‚_f p &amp;= -E[\delta_k(F)(F/f)] \\
    &amp;= -Ïˆ(k)k/f \\
    &amp;= -(Ï†(x(k)/ks)k/f \\
    &amp;= -Ï†(x(k))/fs \\
    &amp;= -Ï†_s(x(k))/ks \\
\end{aligned}
</span></p>
<p>Digital gamma is <span class="math display">
\begin{aligned}
    âˆ‚_f^2 p &amp;= -E[\delta_k&#39;(F)(F/f)^2] \\
    &amp;= -Ïˆ&#39;(k)(k/f)^2 \\
    &amp;= -((Ï†&#39;(x(k)) - Ï†(x(k))s)/k^2s^2))(k/f)^2 \\
    &amp;= -(Ï†&#39;(x(k)) - Ï†(x(k))s)/f^2s^2) \\
\end{aligned}
</span></p>
<p>Digital put vega is <span class="math display">
\begin{aligned}
âˆ‚_s p &amp;= -E_s[\delta_k(F)F(X - s)] \\
    &amp;= -Ïˆ(k)k(x(k) - s) \\ 
    &amp;= -(Ï†(x(k))/ks)k(x(k) - s) \\ 
    &amp;= -Ï†(x(k))(x(k) - s)/s \\ 
\end{aligned}
</span></p>
</section>
<section id="black-model" class="level2">
<h2>Black Model</h2>
<p>We use the above to derive the standard Black-Scholes/Merton formulas for value and greeks. In the Black model <span class="math inline">F = fe^{ÏƒB_t - Ïƒ^2t/2}</span> where <span class="math inline">f</span> is the forward, <span class="math inline">Ïƒ</span> is the volatility, and <span class="math inline">B_t</span> is Brownian motion at time <span class="math inline">t</span>. There is really no need to drag in Brownian motion to compute an option value, we only use the fact <span class="math inline">B_t</span> is normally distributed with mean <span class="math inline">0</span> and variance <span class="math inline">t</span>. There is also no need to drag in <span class="math inline">t</span>, let <span class="math inline">s = Ïƒ\sqrt{t}</span> and <span class="math inline">X</span> be standard normal so <span class="math inline">F = fe^{sX - s^2/2}</span> has the same distribution.</p>
<p><a href="cdf.html#normal">Recall</a> if <span class="math inline">X</span> is standard normal then <span class="math inline">E[e^{Î¼ + Ïƒ X}] = e^{Î¼ + Ïƒ^2/2}</span> and <span class="math inline">E[g(X)e^{s X - s^2/2}] = E[g(X + s)]</span> for any function <span class="math inline">g</span> and <span class="math inline">s\in ğ‘¹</span>. These formulas imply the cumulant of a standard normal is <span class="math inline">Îº(s) = s^2/2</span> and <span class="math inline">Î¦_s(x) = P_s(X\le x) = E[1(X\le x)e^{s X - s^2/2}] = P(X + s \le x) = Î¦(x - s)</span>. Note <span class="math inline">Ï†_s(x) = Ï†(x - s)</span> and <span class="math inline">âˆ‚Î¦_s(x)/âˆ‚s = -Ï†(x - s) = -Ï†_s(x)</span>.</p>
<p>Put value is <span class="math display">
    p = k Î¦(x(k)) - f Î¦(x(k) - s)
</span> where <span class="math inline">x(k) = \log(k/f)/s + s/2</span>.</p>
<p><strong>Exercise</strong>. <em>Show <span class="math inline">x(k) = \log(k/f)/s + s/2 = -d_2</span> and <span class="math inline">x(k) - s = \log(k/f)/s - s/2 = -d_1</span></em>.</p>
<p>Hint: The Black-Scholes/Merton formulas use <span class="math inline">d_1 = (\log(f/k) + s^2/2)/s</span> and <span class="math inline">d_2 = d_1 - s</span>.</p>
<p>Put delta is <span class="math display">
    âˆ‚_f p = -Î¦_s(x(k)) = -Î¦(x(k) - s).
</span></p>
<p>Gamma is <span class="math display">
    âˆ‚_f^2 p = Ï†(x(k))k/f^2s = Ï†_s(x(k))/fs.
</span></p>
<p>Vega is <span class="math display">
\begin{aligned}
    âˆ‚_s v &amp;= -f âˆ‚_s Î¦_s(x(k)) \\
    &amp;= fÏ†(x(k) - s) = fÏ†_s(x(k)).
\end{aligned}
</span></p>
</section>
<section id="spot" class="level2">
<h2>Spot</h2>
<p>The Black-Merton/Scholes model uses <em>spot</em> prices instead of forward. If a risk-free bond has realized return <span class="math inline">R</span> over the period the value of the underlying at expiration is <span class="math inline">U = Rue^{sX - Îº(s)}</span>. Since <span class="math inline">F = U</span> we have <span class="math inline">f = Ru</span>. The <em>spot</em> value of the option is <span class="math inline">v_0 = E[Î½(U)]/R</span>. We have <span class="math display">
âˆ‚_u v_0 = E[Î½&#39;(U) âˆ‚_u U]/R
= E[Î½&#39;(F) âˆ‚_f F âˆ‚_u f]/R
= E[Î½&#39;(F) âˆ‚_f F R]/R = âˆ‚_f v.
</span> Spot and forward delta are equal but the spot gamma is <span class="math display">
âˆ‚_u^2 v_0 = âˆ‚_u âˆ‚_f v = âˆ‚_f^2 v âˆ‚_u f = âˆ‚_f^2 v R.
</span> Spot vega is <span class="math display">
âˆ‚_s v_0 = E[Î½&#39;(U) âˆ‚_s U]/R = E[Î½&#39;(F) âˆ‚_s F/R = âˆ‚_s v/R.
</span></p>
</section>
<section id="remarks" class="level2">
<h2>Remarks</h2>
<p>Let <span class="math inline">X</span> have cdf <span class="math inline">Î¦(x) = P(X\le x)</span> and pdf <span class="math inline">Ï†(x) = Î¦&#39;(x)</span>. <span class="math display">
    K(s,x) = E[1(X\le x) e^{sX}], K(s) = E[e^{sX}]
</span> be the partial, moment generating function and <span class="math inline">Îº(s,x) = \log K(s,x)</span>, <span class="math inline">Îº(s) = \log K(s)</span> be the partial, cumulant generating function of <span class="math inline">X</span>.</p>
<p>Let <span class="math inline">Îµ_s(x) = e^{sx}/K(s) = e^{sx - Îº(s)}</span>.</p>
<p>If <span class="math inline">X</span> is standard normal <span class="math inline">K(s,x) = e^{s^2/2}Î¦(x - s)</span> and <span class="math inline">K(s) = e^{s^2/2}</span>.</p>
<p><span class="math inline">Î¦_s(x) = K(s,x)/K(s)</span>. If <span class="math inline">X</span> is standard normal <span class="math inline">Î¦_s(x) = Î¦(x - s)</span>.</p>
<p><span class="math inline">âˆ‚_x K(s,x) = E[Î´_x(X) e^{sX}] = e^{sx} Ï†(x)</span></p>
<p><span class="math inline">âˆ‚_x Î¦_s(x) = e^{sx} Ï†(x)/K(s) = e^{sx - Îº(s)} Ï†(x)</span>.</p>
<p><span class="math inline">âˆ‚_x^{n+1} Î¦_s(x) = e^{sx - Îº(s)}\sum_{k=0}^n \binom{n}{k} Ï†^{(n - k)}(x) s^k</span>.</p>
<p><span class="math inline">âˆ‚_s^n K(s,x) = E[1(X\le x) e^{sX} X^n]</span>, <span class="math inline">âˆ‚_s^n K(s) = E[e^{sX} X^n]</span>.</p>
<p><span class="math inline">âˆ‚_s Î¦_s(x) = (K(s)âˆ‚_s K(s, x) - âˆ‚_s K(s) K(s, x))/K(s)^2</span>.</p>
<p><span class="math display">
\begin{aligned}
âˆ‚_x^2 K(s,x) &amp;= s(sK(s,x) + e^{sx} Ï†(x)) + e^{sx}s Ï†(x) + e^{sx}Ï†&#39;(x) \\
    &amp;= s^2 K(s,x) + e^{sx} (2s Ï†(x) + Ï†&#39;(x)\\
\end{aligned}
</span></p>
<p><span class="math display">
\begin{aligned}
âˆ‚_x^3 K(s,x) &amp;= s^2 (s K(s,x) + e^{sx}Ï†(x)) + e^{sx}s(2 Ï†(x) + Ï†&#39;(x)) + e^{sx}(2 Ï†&#39;(x) + Ï†&#39;&#39;(x))\\
    &amp;= s^3 K(s,x) + e^{sx} (3s^2 Ï†(x) + 3Ï†&#39;(x) + Ï†&#39;&#39;(x))\\
\end{aligned}
</span></p>
<p>and <span class="math inline">K(x, s) = \exp(Îº(x,s)) = Î¦_s(x)</span>. We have <span class="math inline">Ï†_s(x) = âˆ‚_x Î¦_s(x) = K_x(x, s) = K(x, s)âˆ‚_x Îº(x,s)</span>.</p>
<p><span class="math display">
\begin{aligned}
Îº_{a + bX}(x,s) &amp;= \log E[1(a + bX \le x) e^{s(a + bX)}] \\
    &amp;= \log e^{as} E[1(X \le (x - a)/b) e^{sbX}] \\
    &amp;= as + Îº_X((x - a)/b, bs) \\
\end{aligned}
</span></p>
</section>
<footer>
Return to <a href="index.html">index</a>.
</footer>
</body>
</html>
