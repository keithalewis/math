<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Keith A. Lewis" />
  <meta name="dcterms.date" content="2025-09-18" />
  <title>Capital Asset Pricing Model</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="math.css" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: true
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">Capital Asset Pricing Model</h1>
<p class="author">Keith A. Lewis</p>
<p class="date">September 18, 2025</p>
<div class="abstract">
<div class="abstract-title">Abstract</div>
Two assets suffice for optimal portfolios.
</div>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#capm" id="toc-capm">CAPM</a></li>
<li><a href="#remarks" id="toc-remarks">Remarks</a></li>
</ul>
</nav>
<p>Let <span class="math inline">I</span> be the set of
<em>instruments</em> available for trading over a period of time and
<span class="math inline">Ω</span> be the set of what can happen over
the period. The <em>prices</em> at the beginning of the period are <span
class="math inline">x\in\mathbf{R}^I</span> where <span
class="math inline">x_i = x(i)\in\mathbf{R}</span> is the initial price
of instrument <span class="math inline">i\in I</span>. The prices at the
end of the period are <span class="math inline">X\colon\Omega\to
\mathbf{R}^I</span> where <span
class="math inline">X(\omega)\in\mathbf{R}^I</span> are the instrument
prices if <span class="math inline">\omega\in\Omega</span> occurred.</p>
<p>A <em>position</em> <span
class="math inline">\xi\in\mathbf{R}^I</span> is the number of shares of
each instrument purchased at the beginning of the period. Its value at
the beginning of the period is <span class="math inline">\xi\cdot
x</span> and its value at the end of the period is <span
class="math inline">\xi\cdot X(\omega)</span> given <span
class="math inline">\omega\in\Omega</span> occurred. The <em>realized
return</em> of <span class="math inline">\xi</span> is the function
<span class="math inline">R_\xi = \xi\cdot X/\xi\cdot x</span>.</p>
<p><strong>Exercise</strong>. <em>Show <span class="math inline">R_\xi =
R_{t\xi}</span> for any non-zero <span
class="math inline">t\in\mathbf{R}</span></em>.</p>
<p>If <span class="math inline">\xi\cdot x\not=0</span> there exists
<span class="math inline">t\in\mathbf{R}</span> with <span
class="math inline">t\xi\cdot x = 1</span> so <span
class="math inline">R_{t\xi} = \xi\cdot X</span>. One unit invested
proportional to <span class="math inline">\xi</span> returns this
amount.</p>
<p>Assume a probability measure on <span
class="math inline">\Omega</span>. This note provides no guidence on how
to do that.</p>
<p>A portfolio <span class="math inline">\xi\in\mathbf{R}^I</span> is
<em>efficient</em> if <span
class="math inline">\operatorname{Var}(R_\xi) \le
\operatorname{Var}(R_\eta)</span> whenever <span
class="math inline">E[R_\xi] = E[R_\eta]</span>, <span
class="math inline">\eta\in\mathbf{R}^I</span>.</p>
<p>Given a realized return <span class="math inline">R</span> we can
find an efficient portfolio by minimizing <span
class="math inline">\operatorname{Var}(R_\xi)</span> given <span
class="math inline">E[R_\xi] = R</span>. This can be solved using
Lagrange multipliers by minimizing <span class="math display">
    \frac{1}{2}\operatorname{Var}(\xi\cdot X) - \lambda(\xi\cdot x - 1)
- \mu(E[\xi\cdot X] - R)
</span></p>
<p>If <span class="math inline">\Sigma = E[XX&#39;] -
E[X]E[X&#39;]</span>, where prime denotes transpose, then the first
order conditions are <span class="math display">
    0 = \xi&#39;\Sigma - \lambda x&#39; - \mu E[X&#39;]
</span> where <span class="math inline">0 = \xi\cdot x - 1</span> and
<span class="math inline">0 = E[\xi\cdot X] - R</span>. Assuming <span
class="math inline">\Sigma</span> is invertible <span
class="math display">
    \xi = \Sigma^{-1}(\lambda x - \mu E[X]).
</span> Note every optimal portfolio is a linear combination of <span
class="math inline">\Sigma^{-1}x</span> and <span
class="math inline">\Sigma^{-1}E[X]</span>.</p>
<p>A portfolio <span class="math inline">\xi\in\mathbf{R}^I</span> is
<em>efficient</em> if <span class="math inline">E[R_\xi] \ge
E[R_\eta]</span> whenever <span
class="math inline">\operatorname{Var}(R_\xi) =
\operatorname{Var}(R_\eta)</span>, <span
class="math inline">\eta\in\mathbf{R}^I</span>.</p>
<p>Given a variance <span class="math inline">V</span> we can find an
efficient portfolio by minimizing <span
class="math inline">E[R_\xi]</span> given <span
class="math inline">\operatorname{Var}(R_\xi) = V</span>. This can be
solved using Lagrange multipliers by minimizing <span
class="math display">
    E[\xi\cdot X] - \lambda(\xi\cdot x - 1) -
\frac{\mu}{2}(\operatorname{Var}(\xi\cdot X) - V)
</span> The first order conditions are <span class="math display">
    0 = E[X&#39;] - \lambda x&#39; - \mu \xi&#39;\Sigma
</span> where <span class="math inline">0 = \xi\cdot x - 1</span> and
<span class="math inline">0 = \operatorname{Var}(\xi\cdot X) - V</span>.
Assuming <span class="math inline">\Sigma</span> is invertible <span
class="math display">
    \xi = \Sigma^{-1}(E[X] - \lambda x)/\mu.
</span> Note every optimal portfolio is a linear combination of <span
class="math inline">\Sigma^{-1}E[X]</span> and <span
class="math inline">\Sigma^{-1}x</span> so the two definitions of
efficient portfolio agree.</p>
<p><strong>Exercise</strong>. <em>If <span
class="math inline">\xi_0\not=\xi_1</span> are any two optimal
portfolios then every optimal portfolio is a linear combination of <span
class="math inline">\xi_0</span> and <span
class="math inline">\xi_1</span></em>.</p>
<p><em>Hint</em>: <span class="math inline">\xi_0 = a\Sigma^{-1}x +
b\Sigma^{-1}E[X]</span> and <span class="math inline">\xi_1 =
c\Sigma^{-1}x + d\Sigma^{-1}E[X]</span> for some <span
class="math inline">a,b,c,d\in\mathbf{R}</span> with <span
class="math inline">ad - bc\not=0</span>.</p>
<section id="capm" class="level2">
<h2>CAPM</h2>
<p>The Capital Asset Pricing model assumes there are two optimal
portfolios, one having variance 0 and the other is called the <em>market
portfolio</em>. If <span class="math inline">\operatorname{Var}(R_\zeta)
= 0</span> then <span class="math inline">\zeta\cdot X</span> is a
constant which we may assume is 1. This is called a <em>zero coupon
bond</em> and <span class="math inline">\zeta\cdot x = 1/R_\zeta</span>
is its initial price, called the <em>discount</em>. Let <span
class="math inline">\mu\in\mathbf{R}^I</span> be the market portfolio
with <span class="math inline">\mu\cdot x = 1</span>.</p>
<p>Every optimal portfolio <span class="math inline">\xi</span> can be
written as <span class="math inline">\xi = \alpha\zeta + \beta\mu</span>
for some <span class="math inline">\alpha,\beta\in\mathbf{R}</span> and
we may assume <span class="math inline">\xi\cdot x = 1</span> so <span
class="math inline">1 = \xi\cdot x = \alpha/R_\zeta + \beta</span> and
<span class="math inline">R_\zeta = \alpha + \beta R_\zeta</span>.
Taking a dot product with <span class="math inline">X</span> in <span
class="math inline">\xi = \alpha\zeta + \beta\mu</span> gives <span
class="math inline">R_\xi = \alpha + \beta R_\mu</span> hence <span
class="math display">
    R_\xi - R_\zeta = \beta(R_\mu - R_\zeta).
</span></p>
<p><strong>Exercise</strong>. <em>Show <span class="math inline">\beta =
\operatorname{Cov}(R_\xi,R_\mu)/\operatorname{Var}(R_\mu)</span></em>.</p>
<p><em>Hint</em>: <span class="math inline">\operatorname{Cov}(R_\xi -
R_\zeta, R_\mu) = \operatorname{Cov}(\beta(R_\mu - R_\zeta),
R_\mu)</span>.</p>
<p>The usual CAPM formula is <span class="math inline">E[R_\xi] -
R_\zeta = \beta(E[R_\mu] - R_\zeta)</span> but a much stronger result
holds: there is an equality between random variables, not just their
expectations.</p>
</section>
<section id="remarks" class="level2">
<h2>Remarks</h2>
<p>If <span class="math inline">\Sigma</span> is not invertible then
there are redundent market instruments. These can be removed to ensure
<span class="math inline">\Sigma</span> is invertible.</p>
<!--

## Derivative

A _derivative instrument_ is a function $A\colonΩ\to\RR$ that pays some _amount_
at the end of the period depending on what happened.
If there is a $γ\in\RR^I$ with
$γ\cdot X = A$ then there is a perfect hedge. The _cost_ of
setting up the hedge at the beginning of the period is $γ\cdot x$.

If more things can happen than the number of instruments then it is not
the case perfect hedges always exist.  The usual case is that they do
not and risk management involves the study of how well a derivative can
be hedged.
The basic problem of one-period hedging is to find $γ\in\RR^I$ such that
$γ\cdot X - A$ is "minimized" in some sense.

## Arbitrage

The cost of acquiring $γ$ shares of each instrument at the beginning
of the period is $γ\cdot x$. If that is negative then you make money.
At the end of the period you close the position by selling all of your
shares.  This results in a cash flow of $γ\cdot X$ to your account.
If that is non-negative then you don't lose money.  A one period model
has _arbitrage_ if there exists $γ\in \RR^I$ with $γ\cdot x <
0$ and $γ\cdot X(\omega)\ge0$, $\omega\inΩ$.

## FTAP

The one-period Fundamental Theorem of Asset Pricing states that there is no
arbitrage if and only if there exists a non-negative measure $\Pi$ on $Ω$
such that $x = \int_Ω X\,d\Pi$. If such a measure exists and
$γ\cdot X\ge 0$ then $γ\cdot x \ge 0$ so there is no arbitrage.

We assume $X$ is bounded and $\Pi$ is finitely additive.

**Lemma.** _If $x\in\bm{R}^n$ and $C$ is a closed cone in
$\bm{R}^n$ with $x\not\in C$ then there exists $ξ\in\bm{R}^n$
with $ξ\cdot x < 0$ and $ξ\cdot y \ge0$ for $y\in C$._

Recall that a _cone_ is a subset of a vector space closed under addition
and multiplication by a positive scalar, that is, $C + C\subseteq C$
and $tC\subseteq C$ for $t > 0$.
For example, the set of arbitrage positions is a cone.

_Proof._ Since $C$ is closed and convex there exists $x^*\in C$ with
$0 < ||x^* - x|| \le ||y - x||$ for all $y\in C$.  Let $ξ = x^* - x$.
For any $y\in C$ and $t > 0$ we have $ty + x^*\in C$ so $||ξ|| \le ||ty + ξ||$. 
Simplifying gives $t^2||y||^2 + 2tξ\cdot y\ge 0$. 
Dividing by $t > 0$ and letting $t$ decrease to 0 shows $ξ\cdot y\ge 0$. 
Take $y = x^*$ then $tx^* + x^*\in C$ for $t \ge -1$. By similar reasoning,
letting $t$ increase to 0 shows $ξ\cdot x^*\le 0$ so $ξ\cdot x^* = 0$. 
Since $0 < ||ξ||^2 = ξ\cdot (x^* - x) = -ξ\cdot x$ we have $ξ\cdot x < 0$.
$\blacksquare$

The set of non-negative finitely additive measures is a closed
cone and $X\mapsto \int_Ω X\,d\Pi$ is positive, linear, and continuous
so $C = \{\int_Ω X\,d\Pi \mid \Pi\ge 0\}$ is also a closed cone.
The contrapositive of the FTAP follows from the lemma.

The proof also shows how to find an arbitrage when one exists.
For example, if $Ω$ is a singleton then the cone generated by $X(Ω)$
is $\{tX(ω)\mid t \ge 0\}$ where $Ω = \{ω\}$.  The projection onto the
ray is $e\otimes e$ where $e = X(ω)/\|X(ω)\|$ so $ξ = (x\cdot e)e - x$
is an arbitrage unless $x$ is a positive scalar multiple of $X(ω)$.

Note that the lemma is a purely geometric fact that does not involve measures.
It is usually called Farkas' lemma and is a special case of the Hahn-Banach theorem
in finite dimensional space.

## Hedging

Given a derivative payoff $A$ at the end of the period we wish to
minimize, in some sense, $γ\cdot X - A$ over available hedges $γ\in\RR^I$.

__Lemma__. _Using the notation above $(γ\cdot X - A)^2 = \|(XX')^{1/2}(γ - XA/X'X)\|^2$ on $Ω$_.

Letting $Σ = (XX')^{1/2}$ we have 
$$
    \|Σγ - Σ^{-1}XA\|^2 = γ'XX'γ - 2γ'XA + X'(XX')^{-1}X A^2
$$
so 
$$
\begin{aligned}
(γ\cdot X - A)^2 &= γ'XX'γ - 2γ'XA + A^2 \\
    &= \|Σγ - Σ^{-1}XA\|^2 - X'(XX')^{-1}X A^2 + A^2.\\
\end{aligned}
$$
Since $(XX')X = X(X'X)$ the matrix $XX'$ has eigenvector $X$ with eigenvalue $V = X'X$
as functions on $Ω$.
This implies $Σ^{-1}X = X/\sigma$ and $X'(XX')^{-1}X = 1$ hence
$$
    (γ\cdot X - A)^2 = \|Σ γ - XA/\sigma\|^2 = \|Σ(γ - XA/σ^2)\|^2.
$$

Given a probability measure on $Ω$, $E[(γ\cdot X - A)^2]$ is minimized
when $γ - E[XX']^{-1}E[XA] = 0$. This is analogous to $γ - XA/σ^2$
being "minimized" over $Ω$. 

If $Ω = \{ω\}$ is a singleton then $γ^* = X(ω)A(ω)/\|X(ω)\|^2$ is the natural choice for the
best estimate. If the model is arbitrage free then $Rx = X(ω)$ for some $R > 0$ and
$γ\cdot x = A(ω)/R$ is the cost of the hedge. In this case $γ\cdot X(ω) = A(ω)$ replicates the derivative
and $X(ω)X'(ω) = R^2xx'$ so $R = \|X\|/\|x\|$.

If $Ω = \{ω_0, ω_1\}$ has two points then $XX'$ is rank two.
If $u,v\in\RR^I$ then the SVD of $uu' + vv'$ in terms of the basis $\{u,v\}$ has eigenvalues 
$$
(a^2 + c^2 \pm \sqrt{(a^2 - c^2)^2 + (2b)^2})/2
$$
where $a^2 = u'u = \|u\|^2$,
$c^2 = v'v = \|v\|^2$, and
$b = u'v = v'u = ρac$.
Note $\|u \pm v\|^2 = a^2 \pm 2b + c^2$.
The eigenvectors are
$$
(a^2 - c^2 \pm \sqrt{(a^2 - c^2)^2 + (2b)^2}, 2b).
$$
Note these are orthogonal and if $a = c$ the eigenvalues are
$a^2 \pm b$, and the eigenvectors are $2(\pm b, b)$

Using $\sqrt{d + x} \approx \sqrt{d} + x/2\sqrt{d}$ for small $x$, the eigenvalues for small $ρ$
are $(a^2 + c^2 \pm |a^2 - c^2| + 2b^2)/2$.
If $a \ge c$ these are $a^2 + b^2/sqrt{a^c - c^2}$ and $c^2 - b^2/sqrt{a^c - c^2}$.
The corresponding eigenvectors are
$(a^2 - c^2 \pm |a^2 - c^2| + 2b^2, 2b)$.
If $a \ge c$ these are $2(a^2 - c^2 + b^2, b)$ and $2(-b^2, b)$.

$$
-(a^2 - c^2 + b^2)b^2 + (b+e)^2$.
= -(a^2 - c^2 + b^2)b^2 + b^2 + 2be + e^2$
$$
$$
    e = -b \pm \sqrt{b^2 + b((a^2 - c^2 + b^2)b^2}
$$

Let $d^2 = a^2 - c^2$ assuming $a \ge c$.
$$
\|(d \pm \sqrt{d^2 + 4b^2})u + 2bv\|^2
$$
$$
= (d \pm \sqrt{d^2 + 4b^2})^2 u'u
  + 2(d \pm \sqrt{d^2 + 4b^2})2b u'v
  + 4b^2 v'v
$$  
$$  
= (d \pm \sqrt{d^2 + 4b^2})^2 a^2
  + 4(d \pm \sqrt{d^2 + 4b^2})b^2
  + 4b^2 c^2
$$
$$
= (d^2 \pm 2d\sqrt{d^2 + 4b^2} + d^2 + 4b^2) a^2
  + 4(d \pm \sqrt{d^2 + 4r^2})b^2
  + 4b^2 c^2
$$
$$
= (a^2d^2 \pm 2a^2d\sqrt{d^2 + 4b^2} + a^2d^2 + 4a^2b^2)
  + 4b^2d \pm 4b^2\sqrt{d^2 + 4r^2}
  + 4b^2 c^2
$$
$$
= 2a^2d^2 + 4a^2b^2
+ 4b^2d
+ 4b^2 c^2
\pm (2a^2d + 4b^2)\sqrt{d^2 + 4b^2}
$$

In general we can do a principal component analysis on $\{X(ω)A(ω)/\|X(ω)\|^2\mid ω\in Ω\}$ and
choose $γ^*$ to be first principal component.

Fix a probability measure and let $Σ = E[XX']^{1/2}$ so
$$
\begin{aligned}
E[(γ\cdot X - A)^2] &= γ'E[XX']γ - 2E[X'A]γ + E[A^2]\\
    &= \|Σγ - Σ^{-1}E[XA]\|^2 - \|Σ^{-1}E[XA]\|^2 + E[A^2].\\
\end{aligned}
$$
This has minimum value $E[A^2] - E[X'A]E[XX']^{-1}E[XA]$ when $γ = E[XX']^{-1}E[XA]$.
The least squares minimum does not depend on initial prices $x$, but we are only
interested in arbitrage free models. In this case we have $x = \int X\,dΠ = E[X]\|Π\|$
where we use the probability measure $P = Π/\|Π\|$.


### Two Instruments

Let $x = (r, s)$, $r,s\in\RR$ and $X = (R, S)$, $R,S\colonΩ\to\RR$.
We may assume $r = s = 1$. The matrix $XX'$ has eigenvectors
$(R/S, 1)$ and $(-S/R, 1)$ with eigenvalues $σ^2 = R^2 + S^2$ and $0$, respectively.

We have
$$
E[XX'] = \begin{pmatrix} E[R^2] & E[RS] \\ E[SR] & E[S^2] \end{pmatrix}
$$
and
$$
E[XX']^{-1} = \frac{1}{E[R^2]E[S^2] - E[RS]^2} 
\begin{pmatrix} E[S^2] & -E[RS] \\ -E[SR] & E[R^2] \end{pmatrix}
$$
The eigenvalues of $E[XX']$ are
$$
(E[R^2] + E[S^2] \pm \sqrt{(E[R^2] - E[S^2])^2 + 4 E[RS]^2})/2
$$
and
The corresponding eigenvectors are
$$
((E[R^2] - E[S^2] \pm \sqrt{(E[R^2] - E[S^2])^2 + 4 E[RS]^2})/2E[RS], 1).
$$

$E[X^2] = E[X]^2 + Var(X)$

-->
</section>
</body>
</html>
