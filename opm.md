---
title: One Period Model
author: Keith A. Lewis
institution: KALX, LLC
email: kal@kalx.net
classoption: fleqn
abstract: Buy now, sell later
...

\newcommand\RR{\bm{R}}

Let $I$ be the set of _instruments_ available for trading.
The _prices_ at the beginning of the period are $x\in\RR^I$ where $x_i\in\RR$ is the initial
price of instrument $i\in I$.
Let $\Omega$ be what can happen over the period.
The prices at the end of the period are $X\colon\Omega\to \RR^I$ where $X(\omega)\in\RR^I$
are the instrument prices if $\omega\in\Omega$ occurred.

## Derivative

A _derivative instrument_ is a function $A\colon\Omega\to\RR$ that pays some _amount_
at the end of the period depending on what happened.
If there is a $γ\in\RR^I$ with
$γ\cdot X = A$ then there is a perfect hedge. The _cost_ of
setting up the hedge at the beginning of the period is $γ\cdot x$.

If more things can happen than the number of instruments then it is not
the case perfect hedges always exist.  The usual case is that they do
not and risk management involves the study of how well a derivative can
be hedged.

## Arbitrage

The cost of acquiring $γ$ shares of each instrument at the beginning
of the period is $γ\cdot x$. If that is negative then you make money.
At the end of the period you close the position by selling all of your
shares.  This results in a cash flow of $γ\cdot X$ to your account.
If that is non-negative then you don't lose money.  A one period model
has _arbitrage_ if there exists $γ\in \RR^I$ with $γ\cdot x <
0$ and $γ\cdot X(\omega)\ge0$, $\omega\in\Omega$.

## FTAP

The one-period Fundamental Theorem of Asset Pricing states that there is no
arbitrage if and only if there exists a non-negative measure $\Pi$ on $\Omega$
such that $\int_\Omega X\,d\Pi = x$. If such a measure exists and
$γ\cdot X\ge 0$ then $γ\cdot x \ge 0$ so there is no arbitrage.

We assume $X$ is bounded and $\Pi$ is finitely additive.

**Lemma.** _If $x\in\bm{R}^n$ and $C$ is a closed cone in
$\bm{R}^n$ with $x\not\in C$ then there exists $ξ\in\bm{R}^n$
with $ξ\cdot x < 0$ and $ξ\cdot y \ge0$ for $y\in C$._

Recall that a _cone_ is a subset of a vector space closed under addition
and multiplication by a positive scalar, that is, $C + C\subseteq C$
and $tC\subseteq C$ for $t > 0$.
For example, the set of arbitrage positions is a cone.

_Proof._ Since $C$ is closed and convex there exists $x^*\in C$ with
$0 < ||x^* - x|| \le ||y - x||$ for all $y\in C$.  Let $ξ = x^* - x$.
For any $y\in C$ and $t > 0$ we have $ty + x^*\in C$ so $||ξ|| \le ||ty + ξ||$. 
Simplifying gives $t^2||y||^2 + 2tξ\cdot y\ge 0$. 
Dividing by $t > 0$ and letting $t$ decrease to 0 shows $ξ\cdot y\ge 0$. 
Take $y = x^*$ then $tx^* + x^*\in C$ for $t \ge -1$. By similar reasoning,
letting $t$ increase to 0 shows $ξ\cdot x^*\le 0$ so $ξ\cdot x^* = 0$. 
Since $0 < ||ξ||^2 = ξ\cdot (x^* - x) = -ξ\cdot x$ we have $ξ\cdot x < 0$.
$\blacksquare$

The set of non-negative finitely additive measures is a closed
cone and $X\mapsto \int_\Omega X\,d\Pi$ is positive, linear, and continuous
so $C = \{\int_\Omega X\,d\Pi \mid \Pi\ge 0\}$ is also a closed cone.
The contrapositive of the FTAP follows from the lemma.

The proof also shows how to find an arbitrage when one exists.
For example, if $Ω$ is a singleton then the cone generated by $X(Ω)$
is $\{tX(ω)\mid t \ge 0\}$ where $Ω = \{ω\}$.  The projection onto the
ray is $e\otimes e$ where $e = X(ω)/\|X(ω)\|$ so $ξ = (x\cdot e)e - x$
is an arbitrage unless $x$ is a positive scalar multiple of $X(ω)$.

Note that the lemma is a purely geometric fact that does not involve measures.
It is usually called Farkas' lemma and is a special case of the Hahn-Banach theorem
in finite dimensional space.

## Hedging

Given a derivative payoff $A$ at the end of the period we wish to
minimize, in some sense, $γ\cdot X - A$ over available hedges $γ\in\RR^I$.

__Lemma__. _Using the notation above $(γ\cdot X - A)^2 = \|(XX')^{1/2}(γ - XA/X'X)\|^2$ on $Ω$_.

Letting $Σ = (XX')^{1/2}$ we have 
$$
	\|Σγ - Σ^{-1}XA\|^2 = γ'XX'γ - 2γ'XA + X'(XX')^{-1}X A^2
$$
so 
$$
\begin{aligned}
(γ\cdot X - A)^2 &= γ'XX'γ - 2γ'XA + A^2 \\
	&= \|Σγ - Σ^{-1}XA\|^2 - X'(XX')^{-1}X A^2 + A^2.\\
\end{aligned}
$$
Since $(XX')X = X(X'X)$ the matrix $XX'$ has eigenvector $X$ with eigenvalue $\sigma^2 = X'X$.
This implies $Σ^{-1}X = X/\sigma$ and $X'(XX')^{-1}X = 1$ hence
$$
	(γ\cdot X - A)^2 = \|Σ γ - XA/\sigma\|^2 = \|Σ(γ - XA/σ^2)\|^2.
$$

Recall $E[(γ\cdot X - A)^2]$ is minimized when $γ - E[XX']^{-1}E[XA] = 0$
which is analogous to $γ - XA/X'X$ being "minimized" over $Ω$.
We can think of $XA/σ$ as a collection of unit vectors weighted by $A$
since $σ = \|X\|$.

If $Ω = \{ω\}$ is a singleton then $γ^* = X(ω)A(ω)/\{X(ω)\|^2$ is a natural choice for the
best estimate. If the model is arbitrage free then $Rx = X(ω)$ for some $R > 0$ and
$γ\cdot x = A(ω)/R$ is the cost of the hedge. In this case $γ\cdot X(ω) = A(ω)$ replicates the derivative.

In general we can do a principle component analysis on $\{X(ω)A(ω)/\|X(ω)\|^2\mid ω\in Ω\}$ and
choose $γ^*$ to be first principal component.

<!--

Fix a probability measure and let $\Sigma = E[XX']^{1/2}$ so
$$
\begin{aligned}
E[(γ\cdot X - A)^2] &= γ'E[XX']γ - 2E[X'A]γ + E[A^2]\\
	&= \|\Sigmaγ - \Sigma^{-1}E[XA]\|^2 - \|\Sigma^{-1}E[XA]\|^2 + E[A^2].\\
\end{aligned}
$$
This has minimum value $E[A^2] - E[X'A]E[XX']^{-1}E[XA]$ when $γ = E[XX']^{-1}E[XA]$.
The least squares minimum does not depend on initial prices $x$, but we are only
interested in arbitrage free models. In this case we have $x = \int X\,dΠ = E[X]\|Π\|$
where we use the probability measure $P = Π/\|Π\|$.

-->

### Two Instruments

Let $x = (r, s)$, $r,s\in\RR$ and $X = (R, S)$, $R,S\colon\Omega\to\RR$.
We may assume $r = s = 1$. The matrix $XX'$ has eigenvectors
$(R/S, 1)$ and $(-S/R, 1)$ with eigenvalues $σ^2 = R^2 + S^2$ and $0$, respectively.

We have
$$
E[XX'] = \begin{pmatrix} E[R^2] & E[RS] \\ E[SR] & E[S^2] \end{pmatrix}
$$
and
$$
E[XX']^{-1} = \frac{1}{E[R^2]E[S^2] - E[RS]^2} 
\begin{pmatrix} E[S^2] & -E[RS] \\ -E[SR] & E[R^2] \end{pmatrix}
$$
The eigenvalues of $E[XX']$ are
$$
\frac{E[R^2] + E[S^2] - \sqrt{(E[R^2] - E[S^2])^2 + 4 E[RS]^2}}{2}
$$
and
$$
\frac{E[R^2] + E[S^2] + \sqrt{(E[R^2] - E[S^2])^2 + 4 E[RS]^2}}{2}
$$
Let $rr = E[R^2]$, $ss = E[S^2]$, $rs = E[RS]$, and $δ = \sqrt{(rr - ss)^2 + 4 (rs)^2}$ so
the eigenvalues are $(rr + ss \mp δ)/2$.

The corresponding eigenvectors are $((rr - ss \mp δ)/2rs), 1)$.

$E[X^2] = E[X]^2 + Var(X)$
