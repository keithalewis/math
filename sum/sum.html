<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Simple Unified Model</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
        integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
        integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8"
        crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
        integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
        onload="renderMathInElement(document.body, {delimiters: [{left: '$$', right: '$$', display: true}, {left: '\\[', right: '\\]', display: true}, {left: '$', right: '$', display: false}, {left: '\\(', right: '\\)', display: false}]});"></script>
    <style>
        body {
            font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
            font-size: x-large;
            margin: 2rem;
            background-color: #f8f8f8;
        }

        .katex-display {
            text-align: left !important;
            margin: 1em 0;
            padding-left: 2em;
        }

        .katex-display>.katex {
            text-align: left;
        }

        .graph {
            display: inline-block;
            margin: 2rem 0;
        }

        .hidden-content {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease, transform 0.6s ease;
        }

        .hidden-content.visible {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>

<body>
    <h1>A Simplified Approach...</h1>
    <p>...to the valuation of risky streams [Ross 1978]<i> of cash flows</i>.</p>

    <div class="hidden-content">
        <h2>I: Market</h2>
        <p>Instruments have <i>prices</i> and <i>cash flows</i> over time.</p>
    </div>
    <!--
    <svg id="market" class="graph" viewBox="0 0 300 400" xmlns="http://www.w3.org/2000/svg">
        <defs>
            <marker id="arrowhead" markerWidth="5" markerHeight="3.5" refX="4.5" refY="1.75" orient="auto">
                <polyline points="0 0, 5 1.75, 0 3.5" fill="none" stroke="#333" stroke-width="1" />
            </marker>
        </defs>
        <g transform="translate(20, 120) scale(1, -1)">
            <line x1="0" y1="0" x2="100" y2="0" stroke="#333" stroke-width="1" marker-end="url(#arrowhead)" />
            <line x1="0" y1="0" x2="0" y2="100" stroke="#333" stroke-width="1" marker-end="url(#arrowhead)" />
            <text x="110" y="0" font-size="12" fill="#333" font-style="italic" text-anchor="left"
                dominant-baseline="middle" transform="scale(1, -1)">time</text>
            <text x="0" y="-110" font-size="12" fill="#333" font-style="italic" text-anchor="middle"
                transform="scale(1, -1)">price</text>
        </g>
    </svg>
-->
    <div class="hidden-content">
        <svg id="trading" class="graph" viewBox="0 0 300 400" xmlns="http://www.w3.org/2000/svg">
            <defs>
                <marker id="arrowhead" markerWidth="5" markerHeight="3.5" refX="4.5" refY="1.75" orient="auto">
                    <polyline points="0 0, 5 1.75, 0 3.5" fill="none" stroke="#333" stroke-width="1" />
                </marker>
            </defs>
        </svg>
    </div>

    <div class="hidden-content">
        <h2>II: Trading</h2>
    </div>
    <div class="hidden-content">
        <h2>III: Accounting</h2>
        <p>Trading entails <i>amount</i>s. Cash flows are received proportional to position and
            shares are purchased at market price.
            \[
            A_t = \Delta_t\cdot C_t - \Gamma_t\cdot X_t
            \]
        <p>The <i>value</i> (mark-to-market) is the existing position plus
            trades just done "liquidated" at market price.
            \[
            V_t = (\Delta_t + \Gamma_t)\cdot X_t
            \]
        </p>
    </div>
    <div class="hidden-content">
        <h2>IV:Arbitrage</h2>
        <p>A trading strategy \((\tau_j, \Gamma_j)\) that makes money
            on the first trade; never loses money; and ends with no position:
            \[
            A_{\tau_0} > 0;\, A_t \ge 0, t \ge \tau_0;\, \sum_j \Gamma_j = 0
            \]
    </div>
    <div class="hidden-content">
        <h2>V: Fundamental Theorem of Asset Pricing</h2>
        <p>If there is no arbitrage then prices are discounted future cash flows given
            the available information.</p>
        </p>
        <p>
            \[ X_t D_t = \sum_{u > t} C_u D_u|_{\mathcal{A}_t} \]
        </p>
    </div>
    <div class="hidden-content">
        <h2>Consequences</h2>
        <p>
            If \(M_t = M_u|_{\mathcal{A}_t}\) then
        \[
        X_t D_t = M_t - \sum_{t\le t} C_s D_s
        \]
        is arbitrage free.
    <blockquote>
        <strong>Every arbitrage free price process has the form.</strong>
    </blockquote>
    For example, the Black-Scholes/Merton model is \(D_t = e^{-\rho t}P\), \(M_t = \begin{bmatrix} 1 \\ se^{\sigma B_t -
    \sigma^2t/2} \end{bmatrix} P\),
    \(C_t = \begin{bmatrix} 0 \\ 0 \end{bmatrix}\)
    where \(P\) is Wiener measure is Black-Scholes/Merton.
    <details>
        <summary>Normal</summary>
        <p>If \(N\) is normally distributed then
            \[
            E[e^{N}] = e^{E[N] + \operatorname{Var}(N)/2}
            \]
        </p>
    </details>
    </p>
    </div>
    <div class="hidden-content">
        <p>
            \[ V_t D_t = \sum_{u > t} A_u D_u|_{\mathcal{A}_t} \]
        </p>
    </div>

    <script>
        // Scroll reveal functionality
        function revealOnScroll() {
            const hiddenElements = document.querySelectorAll('.hidden-content');
            
            hiddenElements.forEach(element => {
                const elementTop = element.getBoundingClientRect().top;
                const windowHeight = window.innerHeight;
                
                // Reveal when element is 150px from bottom of viewport
                if (elementTop < windowHeight - 150) {
                    element.classList.add('visible');
                }
            });
        }

        // Run on page load and scroll
        window.addEventListener('scroll', revealOnScroll);
        window.addEventListener('load', revealOnScroll);

        function lineElement(x1, y1, x2, y2,
            { stroke = '#333', strokeWidth = 1, markerEnd = null } = {}) {
            const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');

            line.setAttribute('x1', x1);
            line.setAttribute('y1', y1);
            line.setAttribute('x2', x2);
            line.setAttribute('y2', y2);
            line.setAttribute('stroke', stroke);
            line.setAttribute('stroke-width', strokeWidth);
            if (markerEnd) {
                line.setAttribute('marker-end', markerEnd);
            }

            return line;
        }
        function animateElement(attributeName, from, to,
            { dur = '1s', fill = 'freeze', begin = '0s' } = {}) {
            const animate = document.createElementNS('http://www.w3.org/2000/svg', 'animate');

            animate.setAttribute('attributeName', attributeName);
            animate.setAttribute('from', from);
            animate.setAttribute('to', to);
            animate.setAttribute('dur', dur);
            animate.setAttribute('fill', fill);
            animate.setAttribute('begin', begin);

            return animate;
        }

        function drawTrading() {
            const svg = document.getElementById('trading');
            const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');

            // Set attributes
            g.setAttribute('class', 'graph');
            g.setAttribute('transform', 'translate(20, 280) scale(1, -1)');

            // Append to SVG
            svg.appendChild(g);

            // Add children to the group
            g.appendChild(lineElement(0, 0, 5, 0, { markerEnd: 'url(#arrowhead)' }))
                .appendChild(animateElement('x2', '5', '100', { dur: '1s' }));
    //    <text x="110" y="0" font-size="12" fill="#333" font-style="italic" text-anchor="left"
    //            dominant-baseline="middle" transform="scale(1, -1)">time</text>
    
            const line2 = lineElement(0, 0, 0, 5, { markerEnd: 'url(#arrowhead)' });
            line2.setAttribute('visibility', 'hidden');
            
            // Make visible when animation starts
            const setVisible = document.createElementNS('http://www.w3.org/2000/svg', 'set');
            setVisible.setAttribute('attributeName', 'visibility');
            setVisible.setAttribute('to', 'visible');
            setVisible.setAttribute('begin', '1s');
            line2.appendChild(setVisible);
            
            line2.appendChild(animateElement('y2', '5', '100', { dur: '1s', begin: '1s' }));
            g.appendChild(line2);
        }
       
        drawTrading();
    </script>
</body>

</html>