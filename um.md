---
title: A Unified Model of Derivative Securities
author: Keith A. Lewis
institution: KALX, LLC
email: kal@kalx.net
classoption: fleqn
abstract: |
	Market instruments can be bought or sold at a price and ownership
	entails cash flows. Shares of instruments can be traded based on
	available information that accrue to positions. The mark-to-market
	value and amounts involved with trading correspond to price
	and cash flows. The Unified Model demonstrates the connection
	between dynamic trading and how to value, hedge, and manage the
	risk of a derivative security.

	It can be used for any portfolio of instruments.

	Every arbitrage-free model of prices and cash flows is
	parameterized by a vector-valued martingale whose components are
	indexed by market instruments and a positive, adapted process
	called a deflator. If repurchase agreements are available they
	determine a canonical deflator.
...

A _derivative security_ is a contract between two parties: I will
give you this on these dates if you will give me that on those dates.
Derivatives must have existed since before recorded history.  The Nobel
prize winning breakthrough of Black, Scholes, and Merton was
how to synthesize derivatives by dynamically trading market instruments
based on the borrowing cost used to fund the hedge instead of trying to
estimate the growth rate of the underlying securities.

This paper provides a unified model for valuing, hedging, and
managing the risk of any derivative security. It shows how they can
be synthesized by trading market instruments and turns the spotlight on
what may be the next Nobel prize winning problem: how should you hedge
if you can't do it continuously?

The Unified Model can also be used for any portfolio of stocks, bonds,
convertible bonds, structured products, currencies, commodities, and
even other derivatives in the portfolio.

## Market Model

We assume the usual setup, $\langle\Omega, P, (\AA_t)_{t\in T}\rangle$,
of a sample space $\Omega$, a probability measure $P$, and an
increasing filtration of algebras $(\AA_t)$ over the set of trading
times $T$. If you are not familiar with this see the Notation section below.

Every _instrument_ has a _price_, $X_t$, and a _cash flow_, $C_t$, at any
trading time, $t\in T$.  Instruments are assumed to be perfectly liquid:
they can be bought or sold at the given price in any amount. Cash flows
are associated with owning an instrument and are almost always 0; stocks
have dividends, bonds have coupons, European options have exactly one
cash flow at expiration. Futures always have price 0.

A _market model_ specifies _prices_
$X_{t}\colon\AA_{t} \rightarrow \RR^{I}$, and _cash flows_
$C_{t}\colon\AA_{t} \rightarrow \RR^{I}$, where $I$ are the
available market instruments.

We use the notation $X\colon\AA\to\RR$ to indicate $X\colon\Omega\to\RR$
is $\AA$-measurable. If $\AA$ is finite then it is generated by
its atoms and $X$ _is_ a function from the atoms of $\AA$ to $\RR$.

## Trading

A _trading strategy_ is a finite collection of strictly increasing
stopping times, $\tau_{j}$, and trades, $\Gamma_{j}:\AA_{\tau_{j}}
\rightarrow \RR^{I}$ indicating the number of shares to trade
in each instrument. Trades accumulate to a _position_, $\Delta_{t} =
\sum_{\tau_{j} < t}\Gamma_{j} = \sum_{s < t}\Gamma_{s}$ where $\Gamma_{s}
= \Gamma_{j}$ when $s = \tau_{j}$.  Note a trade at time $t$ is not
included in the position at time $t$; it takes some time for trades
to settle.

The _value_ (or _mark-to-market_) of a position at time $t$ is $V_{t} =
\left( \Delta_{t} + \Gamma_{t} \right) \cdot X_{t}$: what you would get
from liquidating your existing position and the trades just executed.
The _amount_ generated by the trading strategy at time $t$ is $A_{t} =
\Delta_{t} \cdot C_{t} - \Gamma_{t} \cdot X_{t}$: you receive the cash
flows associated with your existing position and pay for the trades 
just executed.

## Arbitrage

Arbitrage is a trading strategy with $A_{\tau_{0}} > 0$, $A_{t} \geq 0$
for $t > \tau_{0}$ and $\sum_{j}^{}{\Gamma_{j} = 0}$; make money
on the first trade and never lose until the strategy is closed out.

The Fundamental Theorem of Asset Pricing (FTAP) states there is no arbitrage
if and only if there exists a _deflator_, $D_{t}:\AA_{t} \rightarrow \left(
0,\infty \right)$, with

$$
X_{t}D_{t} = E_t\bigl[X_v D_v + \sum_{t < u \leq v} C_u D_u\bigr].\label{eq:1} \\
$$

We can assume $D_0 = 1$. If $(D_t)$ is a deflator then so is $(D_t/D_0)$.

Note that if there are no cash flows, $C_t = 0$ for all $t \in T$
$X_tD_t$ is a martingale. For an infinite time horizon where
the price times the deflator goes to 0, the current price is
the expected value of discounted future cash flows, just as in
Graham and Dodd valuation.

A consequence of the above and the definition of value and amount is

$$
V_t D_t = E_t\bigl[V_v D_v + \sum_{t < u \leq v}A_u D_u\bigr].\label{eq:2} \\
$$

Note the similarity of the two displayed equations above -- value
corresponds to price and amount corresponds to cash flow.
This is the skeleton key for valuing derivative securities.
It shows how dynamic trading can create synthetic market instruments.

__Proof__. If $u > t$ is sufficiently small then
$X_t D_t = E_t[(X_u + C_u) D_u]$
and
$V_t D_t = (\Delta{t} + \Gamma)\cdot X_{t} D_t
= \Delta_u\cdot E_t[(X_u + C_u) D_u]$.
Since $\Delta_u\cdot C_u = \Gamma_u\cdot X_u + A_u$ we have
$V_t D_t = E_t[(\Delta_u\cdot X_u + \Gamma_u\cdot X_u + A_u) D_u] = E_t[(V_u + A_u)D_u]$.
The displayed formula above follows by induction.

For a trading strategy that closes out,
$V_{\tau_0} D_{\tau_0} = E_{\tau_0}[\sum_{t > \tau_{0}}{A_{t}D_{t}] \geq 0}$. 
Since $V_{\tau_0} =
\Gamma_{\tau_0} \cdot X_{\tau_0}$, $A_{\tau_0} = - \Gamma_{\tau_0} \cdot X_{\tau_0}$, and $D_{\tau_0} > 0$ we have
$A_{\tau_0} \leq 0$.
This proves the "easy" direction of the Fundamental Theorem of Asset Pricing (FTAP).

There is no need to prove the "hard" direction since we have a large supply of arbitrage free models
-- every arbitrage-free model has the form
$X_{t}D_{t} = M_{t} - \sum_{s \leq t}{C_{s}D_{s}}$ where
$M_{t}:\AA_{t} \rightarrow \RR^{I}$ is a martingale and
$D_{t}:\AA_{t} \rightarrow (0,\infty)$.
This is immediate by substituting
$X_{v}D_{v} = M_v - \sum_{s\le v} C_s D_s$ in the first displayed equation.

## Valuing

If a derivative security pays amounts $\bar{A}_j$ at times $\bar{\tau}_j$ and there is
a hedge, $(\Gamma_t)_{t\in T}$, that replicates these amounts, the value
of the derivative is the cost of setting up the initial hedge: $V_0 = \Gamma_0\cdot X_0$.
The hedge must satisfy $A_t = 0$ if $t\not=\bar{\tau}_j$ for all $j$ (_self financing_)
and $A_t = \bar{A}_j$ if $t = \bar{\tau}_j$ for some $j$.

The formula $V_0 = E[\sum_j \bar{A}_j D_{\bar{\tau}_j}]$ is the
value of the initial hedge, $\Gamma_0\cdot X_0$. It can be computed using the
derivative security payments, $\bar{A}_j$, and the deflator.

European options have a single payment, $\bar{A}_T$, at a fixed time $T$
and have value $V_0 = E \bar{A}_T D_T$. Sometimes it is useful to compute this
as $E \bar{A}_T D_T = E^* \bar{A}_T E D_T$, where $E^*$ is the expected value under
the probability measure defined by $dP^*/dP =
D_T/E D_T$. $P^*$ is called the _forward measure_ at time $T$.

## Hedging

The trades at time $t$ are similarly determined by $\Delta_t + \Gamma_t =
dV_t/dX_t$, where the last term is the Fr&#233;chet derivative.  Since we
know the position ($\Delta_t$) at time $t$ this determines the trades:
$\Gamma_t = dV_t/dX_t - \Delta_t$.

In the continuous time case where stocks are modeled by geometric
Brownian motion, this becomes classical Black-Scholes/Merton
delta hedging where delta is $\Delta$ and gamma is $\Gamma$. 
Under their mathematical assumptions, the hedge perfectly replicates the derivative.

In the real world it is not possible to perfectly replicate the derivative security.
There is still research to be done on when to hedge and how to manage the associated risk
of imperfect replication.

Cites - Derman, Dupire, etc.

## Black-Scholes/Merton

The Black-Scholes/Merton model of a stock with no dividends ($C_t = 0$
for all $t$) is specified by the martingale $M_t = (r, s\exp(\sigma B_t
- \sigma^2t/2))$ and deflator $D_t = \exp(-\rho t)$.  No need for Ito's
lemma, partial differential equations, or the Hahn-Banach theorem.

## Canonical Deflator

There is a canonical choice for a deflator if repurchase agreements are available.

### Repurchase Agreement

Assume trades occur at discrete times, as they actually do, so $T = \{t_j\}$ where $t_i < t_j$
if $i < j$.

A _repurchase agreement_ at time $t_j$, $R_j$, has price $X^{R_j}_{t_j}
= 1$ and cash flow $C^{R_j}_{t_{j+1}} = R_j$ so for any arbitrage free
model $D_{t_j} = E_{t_j}[R_j D_{t_{j+1}}]$. We assume $D_{t_{j+1}}$ is $\mathcal{A}_{t_j}$
measurable so $D_{t_j} = R_j D_{t_{j+1}}$ and $D_{t_j} = \Pi_{j<n} R_j^{-1}$.

Define the _forward repo rate_, $f_j$, by $R_j = \exp(f_j\,\Delta t_j)$
where $\Delta t_j = t_{j+1} - t_j$, so $D_{t_j} = \exp(-\sum_{j<n} f_j \Delta_{t_j})$ assuming $D_{t_0} = 1$.
The continuous time version of the _canonical deflator_ is
$D_t = \exp(-\int_0^t f_s\,ds)$.

As we will see below, the prices of all
(non-risky) fixed income securities are determined by the deflator.

### Zero Coupon Bond

A _zero coupon bond_ , $Z(u)$, pays one unit at maturity $u$ so $C^{Z(u)}_u = 1$ is the only cash flow.
An arbitrage free model requires the price at time $t$, $Z_t(u)$, to
satisfy $Z_t(u)D_t = E_t D_u$, so $Z_t(u) = E_t D_u/D_t$. In the continuous time
case $Z_t(u) = E_t\exp(-\int_t^u f_s\,ds)$.

The forward curve, $f(u)$, is defined by $Z_0(u) = \exp(-\int_0^u f(s)\,ds)$.
The forward curve at time $t$, $f_t(u)$, is defined by $Z_t(u) = \exp(-\int_t^u f_t(s)\,ds)$.

### Futures

A _futures_ on underlying $S$ expiring at $t_n$ has price $X_{t_j} = 0$ for all $j$,
cash flows $C_{t_j} = \Phi_{t_j} - \Phi_{t_{j-1}}$ for $0 < j \le n$, where
$\Phi_{t_j}$ is the futures _quote_ at time $t_j$, and $\Phi_{t_n} = S_{t_n}$
at expiration. Since $0 = E_{t_j} (\Phi_{t_{j+1}} - \Phi_{t_j}) D_{t_j}$, we
have $\Phi_{t_j} = E_{t_j} \Phi_{t_{j+1}}$ since $D_{t_j} > 0$ is $t_j$ measurable.

This shows futures quotes are martingales. In particular, the futures quote at $t$ on
the underlying $X$ expiring at $u$ is $\Phi_t(u) = E_t X_u$.

### Forward

A _forward_ contract on underlying $S$ with strike $k$ expiring at time $t$ 
pays $A_t = S_t - k$ at $t$. It has initial value $V_0 = E[(S_t - k)D_t]
= S_0 - kE D_t$.
The _par forward_, $f$, is the strike that makes the initial value equal to zero:
$0 = V_0 = E(S_t - f)D_t$ so $S_0 = fED_t$. This formula is
called the _cost of carry_.

### Put-Call Parity

The first thing every trader checks when using a new model is _put-call parity_.
A (European) _put option_ on underlying $S$ with strike $k$ expiring at time $t$
pays $A^p_t = \max\{k - S_t,0\}$ at $t$.
A _call option_ on underlying $S$ with strike $k$ expiring at time $t$
pays $A^c_t = \max\{S_t - k, 0\}$ at $t$.
Since $A^c_t - A^p_t = S_t - k$ we have $V^c_0 - V^p_0 = c - p = S_0 - k ED_t$, where $c$ and $p$ are the value
of the call and put at time 0. This result is independent of any (arbitrage-free) model.

#### American Option

An American option with strike $k$ and expiration $t$ pays $A_\tau$ at a stopping time $\tau\le t$
at the discretion of the option holder. In the unified model this is represented by extending the
sample space $\Omega$ to $\Omega\times (0,t]$. The point $(\omega,\tau)$ represents exercising
at time $\tau$ when $\omega$ occurs. Note that the model does not assume the option is exercised
at the "optimal" time. In practice, not every market participant does this.

American options do not satisfy put-call parity in general. The exercise time of the put and
the call are usually different.

## Fixed Income

A _fixed income_ instrument is specified by cash flows $(c_j)$ at times $(u_j)$.
This is just a portfolio of zero coupon bonds so its _present value_ is
$p = \sum_j c_j Z(u_j)$.
The present value at time $t$ is $p_t = \sum_j c_j Z_t(u_j)$.

### LIBOR Market Model

Assuming discrete times $(t_j)$, the deflator is determined by the joint distribution of
the repo rates $F_j = F_{t_j}$ over $[t_j, t_{j+1})$. (We use capital $F$ instead of
lower case $f$ to indicate it is a random variable.)

The LIBOR Market model assumes the forwards are jointly lognormal,
$$
	F_j = \phi(t_j)\exp(\Sigma_j\cdot B_{t_j} - ||\Sigma_j||^2 t_j/2),
$$
where $\phi(t_j) = E f_j$ is the futures quote, $\sigma_j$ is a vector with norm
equal to the at-the-money caplet volatility, and $B_t$ is vector-valued Brownian motion.
A nice feature of this model is that the forward curve and at-the-money caplet prices
are not affected by the individual components of the volatility vectors.

A common parameteration for the volatilities is $\Sigma(t) = \sigma(t)(\cos\alpha t, \sin\alpha t)$
for some parameter $\alpha$. Clealy $||\Sigma(t)|| = sigma(t)$. This can be used to fit, e.g., one
swaption price. Note $\Sigma\cdot B_t = \sigma(B_t^0\cos(\alpha t) + B_t^1\sin(\alpha t)$ and
$\Cov(B_t,B_u) = t\cos(\alpha(u-t))$ for $t < u$.

The futures are determined by the forwards and volatilities; $\phi(t) = f(t) + \sigma(t)^2 t^2/2$.

### Forward Rate Agreement

A _forward rate agreement_ over the period $[u, v]$ with coupon $f$ and
day count basis $\delta$ pays $-1$ unit at the
_effective date_ $u$, and $1 + f\delta(u,v)$ at the
_termination date_ $v$, where $\delta(u,v)$ is the [_day count
fraction_](https://en.wikipedia.org/wiki/Day_count_convention) for the
interval.  The day count fraction is approximately equal to the time in years from
$u$ to $v$ for any day count basis.

The _forward par coupon_ at time $t$, $F_t(u,v;\delta)$ is the coupon that makes the price at
time $t\le u$ equal to $0$: $0 = E_t[-D_u + (1 + F_t(u,v;\delta)\delta(u,v))D_v]$.
Hence the par coupon
$$
F_t(u,v;\delta) = (Z_t(u)/Z_t(v) - 1)/\delta(u,v)
$$
is determined by zero coupon bond prices. Note, writing $F_t = F_t(u,v;\delta)$
and $\delta = \delta(u,v)$,
$$
E_t F_t\delta D_v = F_t\delta E_t D_v = E_t[D_u - D_v] = Z_t(u) - Z_t(v)
$$

There are also forward rate agreements not involving the exchange of notional. A
(fixed rate) _payer_ has the single cash flow $(f - F_u(u,v;\delta))\delta(u,v)$ at time $v$.
A _receiver_ has the negative of this cash flow. The value at any time $t \le u$ is
determined by

<!--
f delta - F delta' if different day count basis
-->

\begin{align*}
V_t D_t &= E_t[(f - F_u(u,v;\delta))\delta(u,v) D_v] \\
        &= E_t[f\delta(u,v) D_v - E_u[D_u - D_v]]  \\
        &= E_t[f\delta(u,v) D_v - D_u + D_v]  \\
        &= E_t[-D_u + (1 + f\delta(u,v)) D_v] \\
\end{align*}

which is the same as for a forward rate agreement that does exchange notional.
These two types of FRAS's have very different risk characteristics.
If either counter-party defaults during the time notionals are exchanged the loss can
be much larger than when the payment is only the difference of the fixed and floating rate.

### Interest Rate Swap

An _interest rate swap_ with _calculation dates_ $(t_j)_{j=0}^n$ with coupon $c$, and
day count basis $\delta$ pays $-1$ unit at the effective date $t_0$, $c\delta(t_{j-1},t_j)$
at $t_j$, $0 < j < n$, and $1 + c\delta(t_{n-1},t_n)$ at _termination_ $t_n$.

The _swap par coupon_ at time $t$, $F_t(t_0,\ldots,t_n;\delta)$,
 is the coupon that makes the price at
time $t\le {t_0}$ equal to $0$:
$$
0 = E_t[-D_{t_0} + \sum_{0<j<n} F_t\delta(t_{j-1},t_j) D_{t_j} + (1 + F_t\delta(t_{n-1},t_n) D_{t_n}].
$$
Hence the par coupon,
$F_t(t_0,\ldots,t_n;\delta) = (Z_t(t_0) - Z_t(t_n))/\sum_{0<j\le n}\delta(t_{j-1},t_j) Z_t(t_j)$,
is determined by zero coupon bond prices.

Note that if $n = 1$ this is identical to a forward rate agreement.

There are also interest rate swaps not involving the exchange of notional. A
(fixed rate) _payer_ has the cash flows $(c - F_{t_j}(t_{j-1},t_j;\delta))\delta(t_{j-1},t_j)$ at times $t_j$,
$0 < j \le n$.
A _receiver_ has the negative of these cash flow.

As with forward rate agreements, the coupon making the value at time $t$ equal to zero is
the swap par coupon.

### Floorlet

A _floorlet_ is a put option on an at-the-money _forward rate agreement_.
It pays $\max\{k - F_u(u,v),0\}\delta(u,v)$ at time $v$.
Its value at time $t < u$ is determined by $V_t D_t = E_t \max\{k - F_u(u,v),0\}\delta(u,v) D_u$.
Writing $F_u = F_u(u,v)$ and $\delta = \delta(u,v)$ we have

\begin{align*}
V_t D_t &= E_t[\max\{k - F_u,0\}\delta D_v] \\
        &= E_t[\max\{k\delta - (1/Z_u(v) - 1),0\} D_v] \\
        &= E_t[\max\{1 + k\delta - 1/Z_u(v),0\} D_v] \\
        &= E^*_t[\max\{1 + k\delta - 1/Z_u(v),0\}] E_tD_v \\
        &= E^*_t[\max\{1 + k\delta - 1/Z_u(v),0\}] Z_t(v)D_t \\
\end{align*}
where $E_t^*$ is the expectation under the forward measure $P^*$ defined
by $dP_t^*/dP_t = D_v/E_t D_v$.
This shows the value at $t$ of a floorlet is
$V_t = E^*_t[\max\{1 + k\delta - 1/Z_u(v),0\}] Z_t(v)$.

### Caplet

A _caplet_ is a call option on an at-the-money _forward rate agreement_.
It pays $\max\{F_u(u,v) - k,0\}\delta(u,v)$ at time $v$.
Its value at time $t < u$ is determined by $V_t D_t = E_t \max\{F_u(u,v) - k,0\}\delta(u,v) D_u$.
Similar to floorlets, the value at $t$ of a caplet is
$V_t = E^*_t[\max\{1/Z_u(v) - (1 + k\delta),0\}] Z_t(v)$

### Floor, Cap

A _floor_ and a _cap_ are just a sequence of back-to-back floorlets or caplets.

### Swaption

A _swaption_ is an option on a swap.
It has a single cash flow $\max\{k - F_{t_0}(t_0,\ldots,t_n;\delta), 0\}$ at the
effective date of the swap, $t_0$.

## Remarks

The price of an instrument is not a number. Not only does it
depend on whether you are buying or selling, the amount being
purchased, and the counter-parties involved, determine the price.

The atoms of finance are _exchanges_: $(t;a,i,c;a',i',c')$,
where $t$ is the time of the exchange, $a$ is the amount
of instrument $i$ the _buyer_, $c$, decides to obtain for the amount
$a'$ in instrument $i'$ from the _seller_, $c'$.
$a'$ in instrument $i'$ from the _seller_, $c'$.

We can incorporate more realistic features by defining _price_ to
be a function $X\colon T\times A\times I\times C\times I\times C\to
\RR$, where $T$ is the set of trading times, $A$ the set of
amounts that can be traded, $I$ is the set of market instruments, and $C$
is the set of legal trading entities.
The exchanges available to the buyer at any time $t$ are
$(t;a,i,c;aX(t;a,i;i',c'),i',c')$

### One Period Model

There is no need for probability measures: the Fundamental Theorem of
Asset Pricing is a geometric result. In the one period case where $T =
\{t_0,t_1\}$ the no arbitrage condition is there does not exist $\Gamma_0$
with $A_0 = -\Gamma_0\cdot X_0 > 0$ and $A_1 = \Gamma_0\cdot X_1\ge 0$.

In this case the FTAP states there is no arbitrage if and only if there
exists a positive measure, $\Pi$, on $\Omega$ with $X_0 = \int_\Omega X_1\,d\Pi$.

If $X_0$ belongs to the smallest closed cone containing the range of $X_1$,
then there exists a positive measure, $\Pi$, with $X_0 = \int_\Omega X_1\,d\Pi$.
For any $\gamma\in\RR^I$ such that $\gamma\cdot X_1\ge0$ we have
$\gamma\cdot X_0  = \int_\Omega \gamma\cdot X_1\,d\Pi \ge0$ hence there
can be no arbitrage.

If $X_0$ does not belong to the smallest closed cone containing the range of $X_1$,
then there exists a hyperplane through the origin separating $X_0$ from the cone.
E.g., if $x$ is the closest point in the cone to $X_0$ then $\gamma = x - X_0$ will
do the job.
Let $\gamma$ be a vector in $\RR$ normal to the hyperplane. We can choose $\gamma$
such that $\gamma\cdot X_0 < 0$ and $\gamma\cdot X_1(\omega) \ge0$ for all $\omega\in\Omega$.
This shows arbitrage exists.

If a zero coupon bond exists, i.e., there is a $\zeta\in\RR^I$ with
$\zeta\cdot X_1(\omega) = 1$ for all $\omega\in\Omega$, then
$\zeta\cdot X_0 = \int_\Omega \zeta\cdot X_1\,d\Pi = ||\Pi|| = z$ is the price
of the zero coupon bond and $P = \Pi/z$ is a probability measure.

<!--
### One Period Model Again

Recall the _dual_ of the space of bounded
functions on a set $\Omega$, $B(\Omega)$, is the space of finitely additive
measures on $\Omega$, $ba(\Omega)$.
-->
<!-- cite Dunford Schwartz -->
<!--

Let's assume $X_1\in B(\Omega,\RR^I)$, the set of bounded functions from
$\Omega$ to $\RR^I$. Consider the map $A\colon \RR \oplus B(\Omega)\to\RR^2$
defined by $\Gamma \mapsto (-\Gamma\cdot X_0, \Gamma\cdot X_1)$. No arbitrage
says the range of $A$ does not intersect the cone $\{p \oplus P):p > 0, P\ge 0\}$.
Since the cone has an interior point, the Hahn-Banach theorem implies there exists
a hyperplane that does not intersect the cone. The hyperplane is the kernel of
an element in the dual space $B^* = \RR\oplus ba(\Omega)$, where
$ba(\Omega)$ is the space of finitely additive measures. Call this element
$\pi\oplus\Pi$. We may assume $\pi = 1$.

The adjoint of $A$, $A^*\colon 

### Multi Period Model

The proof above generalizes to the multi-period case...
-->

## Notation

If $\AA$ is an
[_algebra_](https://en.wikipedia.org/wiki/Algebra_of_sets)
on the set $\Omega$ we write
$X\colon\AA\to\RR$ to indicate $X\colon\Omega\to\RR$
is $\AA$-[_measurable_](https://en.wikipedia.org/wiki/Measurable_function).
If $\AA$ is finite then the
[_atoms_](https://en.wikipedia.org/wiki/Atom_(measure_theory))
of $\AA$ form a
[_partition_](https://en.wikipedia.org/wiki/Partition_of_a_set)
of $\Omega$ and being measurable is
equivalent to being constant on atoms. In this case $X$ is indeed a function
on the atoms.

If $\AA$ is an algebra of sets, the
[_conditional expectation_](https://en.wikipedia.org/wiki/Conditional_expectation)
of $X$ given
$\AA$ is defined by $Y = E\left\lbrack X | \AA\right\rbrack$ if and only
if $Y$ is $\AA$ measurable and $\int_A Y\,dP = \int_A X\,dP$
for all $A\in\AA$. This is equivalent to $Y(P|_\AA)
= (XP)|_\AA$ where the vertical bar indicates restriction of a measure.

A _filtration_ indexed by $T\subseteq [0,\infty)$ is an increasing
collection of algebras, $(\AA_t)_{t\in T}$.  A process
$M_{t}\colon\AA_{t} \rightarrow \RR$, $t\in T$, is
a _martingale_ if $M_t = E[M_u | \AA_t] = E_t[M_u]$ for $t\le u$.

A _stopping time_ is a function $\tau\colon\Omega\to T$ such that
$\{\omega\in\Omega\mid \tau(\omega) \le t\}$ belongs to $\AA_t$, $t\in T$.

